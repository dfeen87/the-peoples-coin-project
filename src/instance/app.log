2025-07-12 23:20:50 [INFO] peoples_coin: Creating main Flask application...
2025-07-12 23:20:50 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-12 23:20:50 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-12 23:20:50 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-12 23:20:50 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-12 23:20:50 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-12 23:20:50 [DEBUG] google.auth._default: Cloud SDK credentials not found on disk; not using them
2025-07-12 23:21:00 [WARNING] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client failed to initialize: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-07-12 23:21:00 [INFO] cognitive_system: üêá Starting RabbitMQ consumer loop.
2025-07-12 23:21:00 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:21:00 [INFO] cognitive_system: üß† Cognitive System initialized.
2025-07-12 23:21:00 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-12 23:21:00 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1062e25e0>
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1062e2610> with deadline=9.532443541 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1062e25e0>>, first=True); now=9.532443541; delay=0
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1062e2670> with deadline=9.53302725 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1062e25e0>>; now=9.53302725; delay=0
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:21:00 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: (sqlite3.OperationalError) unable to open database file
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 180, in _do_get
    self._dec_overflow()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 902, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
sqlite3.OperationalError: unable to open database file

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/consensus.py", line 96, in _load_nodes_from_db
    nodes_from_db = session.query(ConsensusNode).all()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3273, in connect
    return self._connection_cls(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2436, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 180, in _do_get
    self._dec_overflow()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 902, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) unable to open database file
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x1062e2700>>
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x1062e2700>>
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:21:00 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x102c9c430>>
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x102c9c400> with deadline=19.555529041 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x102c9c3d0>>; now=9.555529041; delay=10.0
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x102c8d2e0> with deadline=24.555801166000002 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x102c9c3d0>>; now=9.555801166; delay=15.0
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x102c9c430>>
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(12, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x102c9c430>>)
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(12, _) added handler Wr
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57545, 0, 0)>.
2025-07-12 23:21:00 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57545, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57545, 0, 0)>
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(12)
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(12) removed handler
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x102c9c400> with deadline=19.555529041 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x102c9c3d0>>
2025-07-12 23:21:00 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:21:00 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x102c8d2e0> with deadline=24.555801166000002 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x102c9c3d0>>
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:21:00 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x102c9c490>>
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x102c8d5b0> with deadline=19.557960916 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x102c9c3a0>>; now=9.557960916; delay=10.0
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x102c8d910> with deadline=24.558147458 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x102c9c3a0>>; now=9.558147458; delay=15.0
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x102c9c490>>
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(12, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x102c9c490>>)
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(12, _) added handler Wr
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57546)>.
2025-07-12 23:21:00 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57546)>; error=61 (Connection refused)
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57546)>
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(12)
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(12) removed handler
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x102c8d5b0> with deadline=19.557960916 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x102c9c3a0>>
2025-07-12 23:21:00 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:21:00 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:21:00 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x102c8d910> with deadline=24.558147458 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x102c9c3a0>>
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:21:00 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:21:00 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:21:00 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:21:00 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:21:00 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:21:00 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:23:03 [INFO] peoples_coin: Creating main Flask application...
2025-07-12 23:23:03 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-12 23:23:03 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-12 23:23:03 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-12 23:23:03 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-12 23:23:03 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-12 23:23:03 [DEBUG] google.auth._default: Cloud SDK credentials not found on disk; not using them
2025-07-12 23:23:12 [WARNING] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client failed to initialize: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-07-12 23:23:12 [INFO] cognitive_system: üêá Starting RabbitMQ consumer loop.
2025-07-12 23:23:12 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:23:12 [INFO] cognitive_system: üß† Cognitive System initialized.
2025-07-12 23:23:12 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-12 23:23:12 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x107f666a0>
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x107f666d0> with deadline=9.366923625 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x107f666a0>>, first=True); now=9.366923625; delay=0
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x107f66730> with deadline=9.367777458 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x107f666a0>>; now=9.367777458; delay=0
2025-07-12 23:23:12 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: (sqlite3.OperationalError) unable to open database file
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 180, in _do_get
    self._dec_overflow()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 902, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
sqlite3.OperationalError: unable to open database file

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/consensus.py", line 96, in _load_nodes_from_db
    nodes_from_db = session.query(ConsensusNode).all()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3273, in connect
    return self._connection_cls(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2436, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 180, in _do_get
    self._dec_overflow()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 902, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) unable to open database file
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x104ad0940>>
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x104ad0940>>
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:23:12 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x104bf1e50>>
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x104bf1790> with deadline=19.389409541 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bf1fd0>>; now=9.389409541; delay=10.0
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x107f03730> with deadline=24.389479541 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bf1fd0>>; now=9.389479541; delay=15.0
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x104bf1e50>>
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(12, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x104bf1e50>>)
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(12, _) added handler Wr
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57556, 0, 0)>.
2025-07-12 23:23:12 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57556, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57556, 0, 0)>
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(12)
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(12) removed handler
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x104bf1790> with deadline=19.389409541 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bf1fd0>>
2025-07-12 23:23:12 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:23:12 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x107f03730> with deadline=24.389479541 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bf1fd0>>
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:23:12 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x107f03640>>
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x104c003d0> with deadline=19.3911845 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x107f03670>>; now=9.3911845; delay=10.0
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x104bf1ee0> with deadline=24.391247291 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x107f03670>>; now=9.391247291; delay=15.0
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x107f03640>>
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(12, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x107f03640>>)
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(12, _) added handler Wr
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57557)>.
2025-07-12 23:23:12 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57557)>; error=61 (Connection refused)
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57557)>
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(12)
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(12) removed handler
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x104c003d0> with deadline=19.3911845 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x107f03670>>
2025-07-12 23:23:12 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:23:12 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:23:12 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x104bf1ee0> with deadline=24.391247291 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x107f03670>>
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:23:12 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:23:12 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:23:12 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:23:12 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:23:12 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:23:12 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:27:01 [INFO] peoples_coin: Creating main Flask application...
2025-07-12 23:27:01 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-12 23:27:01 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-12 23:27:01 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-12 23:27:01 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-12 23:27:01 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-12 23:27:01 [DEBUG] google.auth._default: Cloud SDK credentials not found on disk; not using them
2025-07-12 23:27:11 [WARNING] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client failed to initialize: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-07-12 23:27:11 [INFO] cognitive_system: üêá Starting RabbitMQ consumer loop.
2025-07-12 23:27:11 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:27:11 [INFO] cognitive_system: üß† Cognitive System initialized.
2025-07-12 23:27:11 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-12 23:27:11 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106508bb0>
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106508be0> with deadline=9.497502541 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106508bb0>>, first=True); now=9.497502541; delay=0
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106508c40> with deadline=9.498199291 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106508bb0>>; now=9.498199291; delay=0
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:27:11 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: (sqlite3.OperationalError) unable to open database file
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 180, in _do_get
    self._dec_overflow()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 902, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
sqlite3.OperationalError: unable to open database file

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/consensus.py", line 96, in _load_nodes_from_db
    nodes_from_db = session.query(ConsensusNode).all()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3273, in connect
    return self._connection_cls(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2436, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3297, in raw_connection
    return self.pool.connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 180, in _do_get
    self._dec_overflow()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 902, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/pool/base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) unable to open database file
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106508cd0>>
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106508cd0>>
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:27:11 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1031b0430>>
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1031b0400> with deadline=19.520479375 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1031b03d0>>; now=9.520479375; delay=10.0
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1031a12e0> with deadline=24.520753540999998 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1031b03d0>>; now=9.520753541; delay=15.0
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1031b0430>>
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(12, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1031b0430>>)
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(12, _) added handler Wr
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57565, 0, 0)>.
2025-07-12 23:27:11 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57565, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57565, 0, 0)>
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(12)
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(12) removed handler
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1031b0400> with deadline=19.520479375 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1031b03d0>>
2025-07-12 23:27:11 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:27:11 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1031a12e0> with deadline=24.520753540999998 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1031b03d0>>
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:27:11 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1031b03a0>>
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1031a1880> with deadline=19.522486583 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1031b0460>>; now=9.522486583; delay=10.0
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1031a1dc0> with deadline=24.522551749999998 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1031b0460>>; now=9.52255175; delay=15.0
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1031b03a0>>
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(12, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1031b03a0>>)
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(12, _) added handler Wr
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57566)>.
2025-07-12 23:27:11 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57566)>; error=61 (Connection refused)
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57566)>
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(12)
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(12) removed handler
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1031a1880> with deadline=19.522486583 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1031b0460>>
2025-07-12 23:27:11 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:27:11 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:27:11 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1031a1dc0> with deadline=24.522551749999998 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1031b0460>>
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:27:11 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:27:11 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:27:11 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:27:11 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:27:11 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:27:11 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:44:31 [INFO] peoples_coin: Creating main Flask application...
2025-07-12 23:44:31 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-12 23:44:31 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-12 23:44:31 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-12 23:44:31 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-12 23:44:31 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-12 23:44:31 [DEBUG] google.auth._default: Cloud SDK credentials not found on disk; not using them
2025-07-12 23:44:40 [WARNING] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client failed to initialize: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-07-12 23:44:40 [INFO] cognitive_system: üêá Starting RabbitMQ consumer loop.
2025-07-12 23:44:40 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:44:40 [INFO] cognitive_system: üß† Cognitive System initialized.
2025-07-12 23:44:40 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-12 23:44:40 [INFO] peoples_coin.consensus: Consensus system configured.
2025-07-12 23:44:40 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Initializing with 2 worker thread(s)...
2025-07-12 23:44:40 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Starting worker pool...
2025-07-12 23:44:40 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-12 23:44:40 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Worker thread started.
2025-07-12 23:44:40 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1081c6130>
2025-07-12 23:44:40 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:40 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker tasks submitted to the pool.
2025-07-12 23:44:40 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:44:40 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:40 [INFO] peoples_coin: All systems initialized.
2025-07-12 23:44:40 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1081c6160> with deadline=9.183432875 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1081c6130>>, first=True); now=9.183432875; delay=0
2025-07-12 23:44:40 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:40 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108311fa0> with deadline=9.185750875 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1081c6130>>; now=9.185750875; delay=0
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108311fd0>>
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108311fd0>>
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:44:40 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108311340>>
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108311400> with deadline=19.187939083 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108311b20>>; now=9.187939083; delay=10.0
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108311280> with deadline=24.188020541 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108311b20>>; now=9.188020541; delay=15.0
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108311340>>
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108311340>>)
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57587, 0, 0)>.
2025-07-12 23:44:40 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57587, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57587, 0, 0)>
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108311400> with deadline=19.187939083 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108311b20>>
2025-07-12 23:44:40 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:44:40 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108311280> with deadline=24.188020541 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108311b20>>
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:44:40 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108311be0>>
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108307280> with deadline=19.189738165999998 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108311250>>; now=9.189738166; delay=10.0
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1083076d0> with deadline=24.189867166 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108311250>>; now=9.189867166; delay=15.0
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108311be0>>
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108311be0>>)
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57588)>.
2025-07-12 23:44:40 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57588)>; error=61 (Connection refused)
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57588)>
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108307280> with deadline=19.189738165999998 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108311250>>
2025-07-12 23:44:40 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:44:40 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:44:40 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1083076d0> with deadline=24.189867166 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108311250>>
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:44:40 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:44:40 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:44:40 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:44:40 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:44:40 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:44:40 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:44:40 [INFO] peoples_coin: All blueprints registered.
2025-07-12 23:44:40 [INFO] peoples_coin: üöÄ Application startup complete.
2025-07-12 23:44:45 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:45 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:45 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:45 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:45 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:45 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:50 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:50 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:50 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:50 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:50 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:50 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:44:50 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x108636100>
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108636ca0> with deadline=19.208971625 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x108636100>>, first=True); now=19.208971625; delay=0
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108636b80> with deadline=19.209162083 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x108636100>>; now=19.209162083; delay=0
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108636b50>>
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108636b50>>
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:44:50 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086365b0>>
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108636b80> with deadline=29.210684166 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086364c0>>; now=19.210684166; delay=10.0
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615bb0> with deadline=34.210748166 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086364c0>>; now=19.210748166; delay=15.0
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086365b0>>
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086365b0>>)
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57591, 0, 0)>.
2025-07-12 23:44:50 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57591, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57591, 0, 0)>
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108636b80> with deadline=29.210684166 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086364c0>>
2025-07-12 23:44:50 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:44:50 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615bb0> with deadline=34.210748166 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086364c0>>
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:44:50 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086365e0>>
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108636610> with deadline=29.212111041 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108636520>>; now=19.212111041; delay=10.0
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108636790> with deadline=34.212172583 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108636520>>; now=19.212172583; delay=15.0
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086365e0>>
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086365e0>>)
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57592)>.
2025-07-12 23:44:50 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57592)>; error=61 (Connection refused)
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57592)>
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108636610> with deadline=29.212111041 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108636520>>
2025-07-12 23:44:50 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:44:50 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:44:50 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108636790> with deadline=34.212172583 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108636520>>
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:44:50 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:44:50 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:44:50 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:44:50 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:44:50 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:44:50 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:44:55 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:55 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:55 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:55 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:55 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:44:55 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:00 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:00 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:00 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:00 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:00 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:00 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:45:00 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1086364f0>
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1086368b0> with deadline=29.21993825 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1086364f0>>, first=True); now=29.21993825; delay=0
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108636730> with deadline=29.220114791 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1086364f0>>; now=29.220114791; delay=0
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108636100>>
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108636100>>
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:45:00 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615430>>
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615a90> with deadline=39.221829375 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086153d0>>; now=29.221829375; delay=10.0
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615cd0> with deadline=44.22189175 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086153d0>>; now=29.22189175; delay=15.0
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615430>>
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615430>>)
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57595, 0, 0)>.
2025-07-12 23:45:00 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57595, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57595, 0, 0)>
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615a90> with deadline=39.221829375 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086153d0>>
2025-07-12 23:45:00 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:45:00 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615cd0> with deadline=44.22189175 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086153d0>>
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:45:00 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615d00>>
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615400> with deadline=39.223202375 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615f70>>; now=29.223202375; delay=10.0
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615640> with deadline=44.2232585 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615f70>>; now=29.2232585; delay=15.0
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615d00>>
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615d00>>)
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57596)>.
2025-07-12 23:45:00 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57596)>; error=61 (Connection refused)
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57596)>
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615400> with deadline=39.223202375 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615f70>>
2025-07-12 23:45:00 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:45:00 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:00 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615640> with deadline=44.2232585 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615f70>>
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:45:00 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:45:00 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:45:00 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:00 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:00 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:45:00 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:45:05 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:05 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:05 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:05 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:05 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:05 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:10 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:10 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:10 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:10 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:10 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:10 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:45:10 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x108615be0>
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615400> with deadline=39.230841875 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x108615be0>>, first=True); now=39.230841875; delay=0
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615d00> with deadline=39.23103575 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x108615be0>>; now=39.23103575; delay=0
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108615430>>
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108615430>>
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:45:10 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086156d0>>
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615d00> with deadline=49.232526 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615250>>; now=39.232526; delay=10.0
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615310> with deadline=54.232602625 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615250>>; now=39.232602625; delay=15.0
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086156d0>>
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086156d0>>)
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57599, 0, 0)>.
2025-07-12 23:45:10 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57599, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57599, 0, 0)>
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615d00> with deadline=49.232526 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615250>>
2025-07-12 23:45:10 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:45:10 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615310> with deadline=54.232602625 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615250>>
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:45:10 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615280>>
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615370> with deadline=49.233864125 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086151c0>>; now=39.233864125; delay=10.0
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615700> with deadline=54.233928208 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086151c0>>; now=39.233928208; delay=15.0
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615280>>
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615280>>)
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57600)>.
2025-07-12 23:45:10 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57600)>; error=61 (Connection refused)
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57600)>
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615370> with deadline=49.233864125 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086151c0>>
2025-07-12 23:45:10 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:45:10 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:10 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615700> with deadline=54.233928208 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086151c0>>
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:45:10 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:45:10 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:45:10 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:10 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:10 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:45:10 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:45:15 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:15 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:15 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:15 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:15 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:15 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:45:20 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:20 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:20 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:20 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1083073a0>
2025-07-12 23:45:20 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:20 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:45:20 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x104bd0490> with deadline=49.247863041 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1083073a0>>, first=True); now=49.247863041; delay=0
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x104bd0400> with deadline=49.248566875 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1083073a0>>; now=49.248566875; delay=0
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x104bd0460>>
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x104bd0460>>
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:45:20 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108636880>>
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x104bc12e0> with deadline=59.25039275 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108636580>>; now=49.25039275; delay=10.0
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x104bc1e20> with deadline=64.250473416 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108636580>>; now=49.250473416; delay=15.0
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108636880>>
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108636880>>)
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57603, 0, 0)>.
2025-07-12 23:45:20 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57603, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57603, 0, 0)>
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x104bc12e0> with deadline=59.25039275 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108636580>>
2025-07-12 23:45:20 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:45:20 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x104bc1e20> with deadline=64.250473416 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108636580>>
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:45:20 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108636b50>>
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108636550> with deadline=59.252023041 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bd0490>>; now=49.252023041; delay=10.0
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108636700> with deadline=64.252097541 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bd0490>>; now=49.252097541; delay=15.0
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108636b50>>
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108636b50>>)
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57604)>.
2025-07-12 23:45:20 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57604)>; error=61 (Connection refused)
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57604)>
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108636550> with deadline=59.252023041 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bd0490>>
2025-07-12 23:45:20 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:45:20 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:20 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108636700> with deadline=64.252097541 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bd0490>>
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:45:20 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:45:20 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:45:20 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:20 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:20 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:45:20 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:45:25 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:25 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:25 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:25 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:25 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:25 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:45:30 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:30 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:30 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:30 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x104bc1760>
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x104bc1ee0> with deadline=59.2600255 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x104bc1760>>, first=True); now=59.2600255; delay=0
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x104bc1730> with deadline=59.260137291 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x104bc1760>>; now=59.260137291; delay=0
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:45:30 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x104bc1fa0>>
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x104bc1fa0>>
2025-07-12 23:45:30 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:45:30 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:45:30 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615280>>
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1086151f0> with deadline=69.261624875 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bc1730>>; now=59.261624875; delay=10.0
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615340> with deadline=74.26166729100001 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bc1730>>; now=59.261667291; delay=15.0
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615280>>
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615280>>)
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57607, 0, 0)>.
2025-07-12 23:45:30 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57607, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57607, 0, 0)>
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1086151f0> with deadline=69.261624875 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bc1730>>
2025-07-12 23:45:30 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:45:30 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615340> with deadline=74.26166729100001 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bc1730>>
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:45:30 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x104bc15b0>>
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x104bc1910> with deadline=69.26243416599999 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bc1880>>; now=59.262434166; delay=10.0
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615220> with deadline=74.26247220799999 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bc1880>>; now=59.262472208; delay=15.0
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x104bc15b0>>
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x104bc15b0>>)
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57608)>.
2025-07-12 23:45:30 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57608)>; error=61 (Connection refused)
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57608)>
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x104bc1910> with deadline=69.26243416599999 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bc1880>>
2025-07-12 23:45:30 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:45:30 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:30 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615220> with deadline=74.26247220799999 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x104bc1880>>
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:45:30 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:45:30 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:45:30 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:30 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:30 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:45:30 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:45:35 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:35 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:35 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:35 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:35 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:35 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:45:40 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1086151c0>
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1086158e0> with deadline=69.2720565 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1086151c0>>, first=True); now=69.2720565; delay=0
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615d00> with deadline=69.273350958 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1086151c0>>; now=69.273350958; delay=0
2025-07-12 23:45:40 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:45:40 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:40 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:40 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:40 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x1086150a0>>
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x1086150a0>>
2025-07-12 23:45:40 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:45:40 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615940>>
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1086159d0> with deadline=79.281483083 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615880>>; now=69.281483083; delay=10.0
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615580> with deadline=84.281574625 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615880>>; now=69.281574625; delay=15.0
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615940>>
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615940>>)
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57611, 0, 0)>.
2025-07-12 23:45:40 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57611, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57611, 0, 0)>
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1086159d0> with deadline=79.281483083 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615880>>
2025-07-12 23:45:40 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:45:40 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615580> with deadline=84.281574625 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615880>>
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:45:40 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615eb0>>
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1086158e0> with deadline=79.283060208 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615670>>; now=69.283060208; delay=10.0
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1086152b0> with deadline=84.283137791 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615670>>; now=69.283137791; delay=15.0
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615eb0>>
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615eb0>>)
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57612)>.
2025-07-12 23:45:40 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57612)>; error=61 (Connection refused)
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57612)>
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1086158e0> with deadline=79.283060208 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615670>>
2025-07-12 23:45:40 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:45:40 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:40 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1086152b0> with deadline=84.283137791 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615670>>
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:45:40 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:45:40 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:45:40 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:40 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:40 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:45:40 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:45:45 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:45 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:45 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:45 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:45 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:45 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:45:50 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1086158e0>
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:45:50 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:50 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615a60> with deadline=79.294138166 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1086158e0>>, first=True); now=79.294138166; delay=0
2025-07-12 23:45:50 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:50 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:45:50 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:50 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615bb0> with deadline=79.297817833 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x1086158e0>>; now=79.297817833; delay=0
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108615550>>
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108615550>>
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:45:50 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615bb0>>
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613580> with deadline=89.301864416 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615130>>; now=79.301864416; delay=10.0
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613b20> with deadline=94.302041208 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615130>>; now=79.302041208; delay=15.0
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615bb0>>
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615bb0>>)
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57615, 0, 0)>.
2025-07-12 23:45:50 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57615, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57615, 0, 0)>
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108613580> with deadline=89.301864416 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615130>>
2025-07-12 23:45:50 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:45:50 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108613b20> with deadline=94.302041208 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615130>>
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:45:50 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615430>>
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615e50> with deadline=89.305910833 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615a00>>; now=79.305910833; delay=10.0
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615af0> with deadline=94.306163375 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615a00>>; now=79.306163375; delay=15.0
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615430>>
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108615430>>)
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57616)>.
2025-07-12 23:45:50 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57616)>; error=61 (Connection refused)
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57616)>
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615e50> with deadline=89.305910833 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615a00>>
2025-07-12 23:45:50 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:45:50 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:50 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108615af0> with deadline=94.306163375 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615a00>>
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:45:50 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:45:50 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:45:50 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:50 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:45:50 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:45:50 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:45:55 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:55 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:55 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:55 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:55 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:45:55 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:00 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:00 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:00 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:00 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:00 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:00 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:46:00 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x108613c40>
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613be0> with deadline=89.316198958 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x108613c40>>, first=True); now=89.316198958; delay=0
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613d60> with deadline=89.316533541 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x108613c40>>; now=89.316533541; delay=0
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108613e20>>
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108613e20>>
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:46:00 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086130d0>>
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613820> with deadline=99.319282625 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086138e0>>; now=89.319282625; delay=10.0
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613d60> with deadline=104.319445 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086138e0>>; now=89.319445; delay=15.0
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086130d0>>
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086130d0>>)
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57619, 0, 0)>.
2025-07-12 23:46:00 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57619, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57619, 0, 0)>
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108613820> with deadline=99.319282625 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086138e0>>
2025-07-12 23:46:00 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:46:00 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108613d60> with deadline=104.319445 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086138e0>>
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:46:00 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108613220>>
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613580> with deadline=99.322257541 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086135b0>>; now=89.322257541; delay=10.0
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613070> with deadline=104.322397916 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086135b0>>; now=89.322397916; delay=15.0
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108613220>>
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108613220>>)
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57620)>.
2025-07-12 23:46:00 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57620)>; error=61 (Connection refused)
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57620)>
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108613580> with deadline=99.322257541 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086135b0>>
2025-07-12 23:46:00 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:46:00 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:00 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108613070> with deadline=104.322397916 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086135b0>>
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:46:00 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:46:00 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:46:00 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:00 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:00 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:46:00 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:46:05 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:05 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:05 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:05 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:05 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:05 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:10 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:10 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:46:10 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:10 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:10 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:10 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x108613640>
2025-07-12 23:46:10 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108615730> with deadline=99.332987916 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x108613640>>, first=True); now=99.332987916; delay=0
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1086150d0> with deadline=99.333400166 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x108613640>>; now=99.333400166; delay=0
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108615520>>
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108615520>>
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:46:10 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108613130>>
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613df0> with deadline=109.335602791 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615670>>; now=99.335602791; delay=10.0
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1086135e0> with deadline=114.335685125 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615670>>; now=99.335685125; delay=15.0
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108613130>>
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108613130>>)
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57623, 0, 0)>.
2025-07-12 23:46:10 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57623, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57623, 0, 0)>
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108613df0> with deadline=109.335602791 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615670>>
2025-07-12 23:46:10 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:46:10 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1086135e0> with deadline=114.335685125 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108615670>>
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:46:10 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086138b0>>
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613520> with deadline=109.33799 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086138e0>>; now=99.33799; delay=10.0
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1086130a0> with deadline=114.338144125 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086138e0>>; now=99.338144125; delay=15.0
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086138b0>>
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086138b0>>)
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57624)>.
2025-07-12 23:46:10 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57624)>; error=61 (Connection refused)
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57624)>
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108613520> with deadline=109.33799 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086138e0>>
2025-07-12 23:46:10 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:46:10 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:10 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1086130a0> with deadline=114.338144125 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086138e0>>
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:46:10 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:46:10 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:46:10 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:10 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:10 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:46:10 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:46:15 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:15 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:15 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:15 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:15 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:15 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:46:20 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:20 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:20 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:20 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x10860a760>
2025-07-12 23:46:20 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:20 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:46:20 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613a90> with deadline=109.349507125 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x10860a760>>, first=True); now=109.349507125; delay=0
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613cd0> with deadline=109.350395041 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x10860a760>>; now=109.350395041; delay=0
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108613820>>
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x108613820>>
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:46:20 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108613940>>
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1086131f0> with deadline=119.353015 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086135e0>>; now=109.353015; delay=10.0
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613cd0> with deadline=124.353208 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086135e0>>; now=109.353208; delay=15.0
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108613940>>
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108613940>>)
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57627, 0, 0)>.
2025-07-12 23:46:20 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57627, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57627, 0, 0)>
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1086131f0> with deadline=119.353015 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086135e0>>
2025-07-12 23:46:20 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:46:20 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108613cd0> with deadline=124.353208 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1086135e0>>
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:46:20 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086138e0>>
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613970> with deadline=119.356334708 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108613100>>; now=109.356334708; delay=10.0
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108613550> with deadline=124.35648525 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108613100>>; now=109.35648525; delay=15.0
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086138e0>>
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1086138e0>>)
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57628)>.
2025-07-12 23:46:20 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57628)>; error=61 (Connection refused)
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57628)>
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108613970> with deadline=119.356334708 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108613100>>
2025-07-12 23:46:20 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:46:20 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:20 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108613550> with deadline=124.35648525 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108613100>>
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:46:20 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:46:20 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:46:20 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:20 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:20 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:46:20 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:46:25 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:25 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:25 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:25 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:25 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:25 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:30 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:30 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:30 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:30 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:30 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:30 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:46:30 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x10860a790>
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x10860a9d0> with deadline=119.364864333 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x10860a790>>, first=True); now=119.364864333; delay=0
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x10860a7f0> with deadline=119.365196791 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x10860a790>>; now=119.365196791; delay=0
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x10860aaf0>>
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x10860aaf0>>
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:46:30 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x10860eb20>>
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x10860e7f0> with deadline=129.367262083 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x10860a760>>; now=119.367262083; delay=10.0
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x10860e910> with deadline=134.367434 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x10860a760>>; now=119.367434; delay=15.0
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x10860eb20>>
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x10860eb20>>)
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57631, 0, 0)>.
2025-07-12 23:46:30 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57631, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57631, 0, 0)>
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x10860e7f0> with deadline=129.367262083 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x10860a760>>
2025-07-12 23:46:30 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:46:30 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x10860e910> with deadline=134.367434 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x10860a760>>
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:46:30 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x10860a2e0>>
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x10860ea30> with deadline=129.370762875 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x10860a490>>; now=119.370762875; delay=10.0
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x10860ed00> with deadline=134.370942041 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x10860a490>>; now=119.370942041; delay=15.0
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x10860a2e0>>
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x10860a2e0>>)
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57632)>.
2025-07-12 23:46:30 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57632)>; error=61 (Connection refused)
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57632)>
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x10860ea30> with deadline=129.370762875 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x10860a490>>
2025-07-12 23:46:30 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:46:30 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:30 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x10860ed00> with deadline=134.370942041 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x10860a490>>
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:46:30 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:46:30 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:46:30 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:30 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:30 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:46:30 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:46:35 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:35 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:35 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:35 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:35 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:35 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:40 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:40 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:40 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:40 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:40 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:40 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:46:40 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x10860e760>
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x10860e880> with deadline=129.380794458 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x10860e760>>, first=True); now=129.380794458; delay=0
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x10860ecd0> with deadline=129.381242625 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x10860e760>>; now=129.381242625; delay=0
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x10860e5e0>>
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x10860e5e0>>
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:46:40 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108666280>>
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108666250> with deadline=139.383926041 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x10860e7f0>>; now=129.383926041; delay=10.0
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108666190> with deadline=144.384080833 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x10860e7f0>>; now=129.384080833; delay=15.0
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108666280>>
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108666280>>)
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57635, 0, 0)>.
2025-07-12 23:46:40 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57635, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57635, 0, 0)>
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108666250> with deadline=139.383926041 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x10860e7f0>>
2025-07-12 23:46:40 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:46:40 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108666190> with deadline=144.384080833 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x10860e7f0>>
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:46:40 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108311ac0>>
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108311400> with deadline=139.387159666 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108311af0>>; now=129.387159666; delay=10.0
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x108666220> with deadline=144.387255666 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108311af0>>; now=129.387255666; delay=15.0
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108311ac0>>
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x108311ac0>>)
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57636)>.
2025-07-12 23:46:40 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57636)>; error=61 (Connection refused)
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57636)>
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108311400> with deadline=139.387159666 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108311af0>>
2025-07-12 23:46:40 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:46:40 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:40 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x108666220> with deadline=144.387255666 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x108311af0>>
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:46:40 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:46:40 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:46:40 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:40 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:46:40 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:46:40 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:46:41 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-12 23:46:41 [INFO] cognitive_system: üß† Sending stop signal to cognitive background loop...
2025-07-12 23:46:41 [INFO] cognitive_system: üß† Cognitive background loop stopped.
2025-07-12 23:46:41 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-12 23:46:41 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread exiting.
2025-07-12 23:46:41 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Worker thread exiting.
2025-07-12 23:46:41 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-12 23:46:41 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-12 23:49:13 [INFO] peoples_coin: Creating main Flask application...
2025-07-12 23:49:13 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-12 23:49:13 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-12 23:49:13 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-12 23:49:13 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-12 23:49:13 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-12 23:49:13 [DEBUG] google.auth._default: Cloud SDK credentials not found on disk; not using them
2025-07-12 23:49:22 [WARNING] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client failed to initialize: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-07-12 23:49:22 [INFO] cognitive_system: üêá Starting RabbitMQ consumer loop.
2025-07-12 23:49:22 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:49:22 [INFO] cognitive_system: üß† Cognitive System initialized.
2025-07-12 23:49:22 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-12 23:49:22 [INFO] peoples_coin.consensus: Consensus system configured.
2025-07-12 23:49:22 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Initializing with 2 worker thread(s)...
2025-07-12 23:49:22 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Starting worker pool...
2025-07-12 23:49:22 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106829a60>
2025-07-12 23:49:22 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:49:22 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Worker thread started.
2025-07-12 23:49:22 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker tasks submitted to the pool.
2025-07-12 23:49:22 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106829eb0> with deadline=9.141294583 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106829a60>>, first=True); now=9.141294583; delay=0
2025-07-12 23:49:22 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:22 [INFO] peoples_coin: All systems initialized.
2025-07-12 23:49:22 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:49:22 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:22 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106285190> with deadline=9.155303166 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106829a60>>; now=9.155303166; delay=0
2025-07-12 23:49:22 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106845790>>
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106845790>>
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:49:22 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106989610>>
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1069895b0> with deadline=19.158116833 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1068a6fa0>>; now=9.158116833; delay=10.0
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106989790> with deadline=24.158180583 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1068a6fa0>>; now=9.158180583; delay=15.0
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106989610>>
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(12, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106989610>>)
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(12, _) added handler Wr
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57644, 0, 0)>.
2025-07-12 23:49:22 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57644, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57644, 0, 0)>
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(12)
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(12) removed handler
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1069895b0> with deadline=19.158116833 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1068a6fa0>>
2025-07-12 23:49:22 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:49:22 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106989790> with deadline=24.158180583 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1068a6fa0>>
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:49:22 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1069897f0>>
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1069899d0> with deadline=19.169976458 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1069897c0>>; now=9.169976458; delay=10.0
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106989280> with deadline=24.170032291 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1069897c0>>; now=9.170032291; delay=15.0
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1069897f0>>
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(12, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x1069897f0>>)
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(12, _) added handler Wr
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57645)>.
2025-07-12 23:49:22 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57645)>; error=61 (Connection refused)
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57645)>
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(12)
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(12) removed handler
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x1069899d0> with deadline=19.169976458 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1069897c0>>
2025-07-12 23:49:22 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:49:22 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:22 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106989280> with deadline=24.170032291 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x1069897c0>>
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:49:22 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:49:22 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:49:22 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:22 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:22 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:49:22 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:49:22 [INFO] peoples_coin: All blueprints registered.
2025-07-12 23:49:22 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-12 23:49:27 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:27 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:27 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:27 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:27 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:27 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:32 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:32 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:32 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:32 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:32 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:32 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:49:32 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106c976a0>
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106c978e0> with deadline=19.180611416 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106c976a0>>, first=True); now=19.180611416; delay=0
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106c97a00> with deadline=19.180774708 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106c976a0>>; now=19.180774708; delay=0
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106c97af0>>
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106c97af0>>
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:49:32 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106cda160>>
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106cda130> with deadline=29.18240925 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106c97850>>; now=19.18240925; delay=10.0
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106cda070> with deadline=34.182475083 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106c97850>>; now=19.182475083; delay=15.0
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106cda160>>
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106cda160>>)
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57648, 0, 0)>.
2025-07-12 23:49:32 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57648, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57648, 0, 0)>
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106cda130> with deadline=29.18240925 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106c97850>>
2025-07-12 23:49:32 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:49:32 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106cda070> with deadline=34.182475083 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106c97850>>
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:49:32 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106c97520>>
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106c97490> with deadline=29.183710333 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106c97880>>; now=19.183710333; delay=10.0
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106c97cd0> with deadline=34.183779833 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106c97880>>; now=19.183779833; delay=15.0
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106c97520>>
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106c97520>>)
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57649)>.
2025-07-12 23:49:32 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57649)>; error=61 (Connection refused)
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57649)>
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106c97490> with deadline=29.183710333 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106c97880>>
2025-07-12 23:49:32 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:49:32 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:32 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106c97cd0> with deadline=34.183779833 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106c97880>>
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:49:32 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:49:32 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:49:32 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:32 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:32 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:49:32 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:49:37 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:37 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:37 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:37 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:37 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:37 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:42 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:42 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:42 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:42 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:42 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:42 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:49:42 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce04c0>
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0130> with deadline=29.192404 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce04c0>>, first=True); now=29.192404; delay=0
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0160> with deadline=29.192732875 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce04c0>>; now=29.192732875; delay=0
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106ce0070>>
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106ce0070>>
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:49:42 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce01c0>>
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0220> with deadline=39.195201416 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce05b0>>; now=29.195201416; delay=10.0
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0610> with deadline=44.195318375 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce05b0>>; now=29.195318375; delay=15.0
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce01c0>>
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce01c0>>)
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57652, 0, 0)>.
2025-07-12 23:49:42 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57652, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57652, 0, 0)>
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce0220> with deadline=39.195201416 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce05b0>>
2025-07-12 23:49:42 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:49:42 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce0610> with deadline=44.195318375 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce05b0>>
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:49:42 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0670>>
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce00d0> with deadline=39.197915291 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0640>>; now=29.197915291; delay=10.0
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0250> with deadline=44.198018875 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0640>>; now=29.198018875; delay=15.0
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0670>>
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0670>>)
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57653)>.
2025-07-12 23:49:42 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57653)>; error=61 (Connection refused)
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57653)>
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce00d0> with deadline=39.197915291 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0640>>
2025-07-12 23:49:42 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:49:42 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:42 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce0250> with deadline=44.198018875 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0640>>
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:49:42 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:49:42 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:49:42 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:42 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:42 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:49:42 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:49:47 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:47 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:47 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:47 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:47 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:47 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:52 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:52 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:52 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:52 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:52 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:49:52 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:52 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce03d0>
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0400> with deadline=39.208476666 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce03d0>>, first=True); now=39.208476666; delay=0
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0190> with deadline=39.209016541 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce03d0>>; now=39.209016541; delay=0
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106ce05b0>>
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106ce05b0>>
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:49:52 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0760>>
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0a90> with deadline=49.212497541 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0a30>>; now=39.212497541; delay=10.0
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0190> with deadline=54.212693875 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0a30>>; now=39.212693875; delay=15.0
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0760>>
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0760>>)
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57656, 0, 0)>.
2025-07-12 23:49:52 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57656, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57656, 0, 0)>
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce0a90> with deadline=49.212497541 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0a30>>
2025-07-12 23:49:52 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:49:52 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce0190> with deadline=54.212693875 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0a30>>
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:49:52 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0af0>>
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce02b0> with deadline=49.215815208 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0ac0>>; now=39.215815208; delay=10.0
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0700> with deadline=54.215941958 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0ac0>>; now=39.215941958; delay=15.0
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0af0>>
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0af0>>)
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57657)>.
2025-07-12 23:49:52 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57657)>; error=61 (Connection refused)
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57657)>
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce02b0> with deadline=49.215815208 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0ac0>>
2025-07-12 23:49:52 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:49:52 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:52 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce0700> with deadline=54.215941958 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0ac0>>
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:49:52 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:49:52 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:49:52 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:52 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:49:52 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:49:52 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:49:57 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:57 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:57 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:57 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:57 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:49:57 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:02 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:02 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:02 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:02 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:02 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:02 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:50:02 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce0310>
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce07c0> with deadline=49.225446583 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce0310>>, first=True); now=49.225446583; delay=0
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0a00> with deadline=49.22582325 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce0310>>; now=49.22582325; delay=0
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106ce0640>>
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106ce0640>>
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:50:02 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0df0>>
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0f40> with deadline=59.228200541 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0ee0>>; now=49.228200541; delay=10.0
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0a00> with deadline=64.22835487500001 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0ee0>>; now=49.228354875; delay=15.0
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0df0>>
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0df0>>)
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57660, 0, 0)>.
2025-07-12 23:50:02 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57660, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57660, 0, 0)>
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce0f40> with deadline=59.228200541 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0ee0>>
2025-07-12 23:50:02 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:50:02 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce0a00> with deadline=64.22835487500001 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0ee0>>
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:50:02 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0fa0>>
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0a30> with deadline=59.231872416 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0f70>>; now=49.231872416; delay=10.0
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0d90> with deadline=64.232019125 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0f70>>; now=49.232019125; delay=15.0
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0fa0>>
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0fa0>>)
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57661)>.
2025-07-12 23:50:02 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57661)>; error=61 (Connection refused)
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57661)>
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce0a30> with deadline=59.231872416 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0f70>>
2025-07-12 23:50:02 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:50:02 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:02 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce0d90> with deadline=64.232019125 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0f70>>
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:50:02 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:50:02 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:50:02 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:02 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:02 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:50:02 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:50:07 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:07 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:07 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:07 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:07 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:07 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:12 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:12 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:12 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:12 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:12 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:12 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:50:12 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce0fd0>
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0eb0> with deadline=59.240881875 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce0fd0>>, first=True); now=59.240881875; delay=0
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0640> with deadline=59.241073416 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce0fd0>>; now=59.241073416; delay=0
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106ce0ac0>>
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106ce0ac0>>
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:50:12 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce6400>>
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce63d0> with deadline=69.243009625 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0eb0>>; now=59.243009625; delay=10.0
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce6310> with deadline=74.243139208 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0eb0>>; now=59.243139208; delay=15.0
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce6400>>
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce6400>>)
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57664, 0, 0)>.
2025-07-12 23:50:12 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57664, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57664, 0, 0)>
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce63d0> with deadline=69.243009625 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0eb0>>
2025-07-12 23:50:12 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:50:12 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce6310> with deadline=74.243139208 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0eb0>>
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:50:12 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce64f0>>
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce6340> with deadline=69.245782416 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce64c0>>; now=59.245782416; delay=10.0
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce62e0> with deadline=74.245939166 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce64c0>>; now=59.245939166; delay=15.0
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce64f0>>
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce64f0>>)
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57665)>.
2025-07-12 23:50:12 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57665)>; error=61 (Connection refused)
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57665)>
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce6340> with deadline=69.245782416 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce64c0>>
2025-07-12 23:50:12 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:50:12 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:12 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce62e0> with deadline=74.245939166 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce64c0>>
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:50:12 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:50:12 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:50:12 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:12 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:12 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:50:12 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:50:17 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:17 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:17 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:17 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:17 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:17 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:22 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:22 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:22 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:22 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:50:22 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:22 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:22 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce0b50>
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0ac0> with deadline=69.257240291 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce0b50>>, first=True); now=69.257240291; delay=0
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce02b0> with deadline=69.257635416 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce0b50>>; now=69.257635416; delay=0
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106ce6520>>
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106ce6520>>
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:50:22 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce69d0>>
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce6940> with deadline=79.2598235 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0ac0>>; now=69.2598235; delay=10.0
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce6400> with deadline=84.260139583 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0ac0>>; now=69.260139583; delay=15.0
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce69d0>>
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce69d0>>)
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57668, 0, 0)>.
2025-07-12 23:50:22 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57668, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57668, 0, 0)>
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce6940> with deadline=79.2598235 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0ac0>>
2025-07-12 23:50:22 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:50:22 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce6400> with deadline=84.260139583 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0ac0>>
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:50:22 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce6820>>
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce6460> with deadline=79.263876666 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce6850>>; now=69.263876666; delay=10.0
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce6340> with deadline=84.264050791 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce6850>>; now=69.264050791; delay=15.0
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce6820>>
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce6820>>)
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57669)>.
2025-07-12 23:50:22 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57669)>; error=61 (Connection refused)
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57669)>
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce6460> with deadline=79.263876666 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce6850>>
2025-07-12 23:50:22 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:50:22 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:22 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce6340> with deadline=84.264050791 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce6850>>
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:50:22 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:50:22 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:50:22 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:22 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:22 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:50:22 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:50:27 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:27 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:27 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:27 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:27 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:27 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:32 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:32 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:50:32 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:32 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:32 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:32 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce6df0>
2025-07-12 23:50:32 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0c10> with deadline=79.274584125 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce6df0>>, first=True); now=79.274584125; delay=0
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce0fa0> with deadline=79.274852791 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x106ce6df0>>; now=79.274852791; delay=0
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106ce0ac0>>
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x106ce0ac0>>
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:50:32 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce6d30>>
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce6250> with deadline=89.276427958 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce6d60>>; now=79.276427958; delay=10.0
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce6280> with deadline=94.276529541 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce6d60>>; now=79.276529541; delay=15.0
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce6d30>>
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce6d30>>)
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57672, 0, 0)>.
2025-07-12 23:50:32 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57672, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57672, 0, 0)>
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce6250> with deadline=89.276427958 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce6d60>>
2025-07-12 23:50:32 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:50:32 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce6280> with deadline=94.276529541 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce6d60>>
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:50:32 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0fd0>>
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce64f0> with deadline=89.278487958 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0b50>>; now=79.278487958; delay=10.0
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x106ce6d90> with deadline=94.278572958 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0b50>>; now=79.278572958; delay=15.0
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0fd0>>
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x106ce0fd0>>)
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57673)>.
2025-07-12 23:50:32 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57673)>; error=61 (Connection refused)
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57673)>
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce64f0> with deadline=89.278487958 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0b50>>
2025-07-12 23:50:32 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:50:32 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:32 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x106ce6d90> with deadline=94.278572958 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x106ce0b50>>
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:50:32 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:50:32 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:50:32 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:32 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:50:32 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:50:32 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:50:37 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:37 [ERROR] peoples_coin.db.db_utils: Database transaction failed. Rolling back. Error: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 35, in get_session_scope
    yield db.session
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:37 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:37 [ERROR] peoples_coin.db.db_utils: Unexpected non-database error during retryable operation: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:37 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:37 [ERROR] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Failed to process batch after all retries: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 117, in _process_goodwill_actions_batch
    processed_count = retry_db_operation(db_op_with_locking, retries=3, delay=2)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/db/db_utils.py", line 65, in retry_db_operation
    return func(*args, **kwargs)
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/endocrine_system.py", line 97, in db_op_with_locking
    session.query(GoodwillAction)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2704, in all
    return self._iter().all()  # type: ignore
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    bind = self.get_bind(**bind_arguments)
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/session.py", line 53, in get_bind
    engines = self._db.engines
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/flask_sqlalchemy/extension.py", line 690, in engines
    raise RuntimeError(
RuntimeError: The current Flask app is not registered with this 'SQLAlchemy' instance. Did you forget to call 'init_app', or did you create multiple 'SQLAlchemy' instances?
2025-07-12 23:50:37 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-12 23:50:37 [INFO] cognitive_system: üß† Sending stop signal to cognitive background loop...
2025-07-12 23:50:37 [INFO] cognitive_system: üß† Cognitive background loop stopped.
2025-07-12 23:50:37 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-12 23:50:37 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread exiting.
2025-07-12 23:50:37 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Worker thread exiting.
2025-07-12 23:50:37 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-12 23:50:37 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-12 23:52:46 [INFO] peoples_coin: Creating main Flask application...
2025-07-12 23:52:46 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-12 23:52:46 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-12 23:52:46 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-12 23:52:46 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-12 23:52:46 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-12 23:52:46 [DEBUG] google.auth._default: Cloud SDK credentials not found on disk; not using them
2025-07-12 23:52:55 [WARNING] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client failed to initialize: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-07-12 23:52:55 [INFO] cognitive_system: üêá Starting RabbitMQ consumer loop.
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:52:55 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-12 23:52:55 [INFO] cognitive_system: üß† Cognitive System initialized.
2025-07-12 23:52:55 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-12 23:52:55 [INFO] peoples_coin.consensus: Consensus system configured.
2025-07-12 23:52:55 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized and ready to start.
2025-07-12 23:52:55 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x103f1bf40>
2025-07-12 23:52:55 [INFO] peoples_coin: All systems initialized.
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x103f1bf70> with deadline=9.230273125 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x103f1bf40>>, first=True); now=9.230273125; delay=0
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x103f1bfa0> with deadline=9.231612583 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x103f1bf40>>; now=9.231612583; delay=0
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x103f34190>>
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x103f34190>>
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:52:55 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x103f05b50>>
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x103f34c70> with deadline=19.236691874999998 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x103f05a60>>; now=9.236691875; delay=10.0
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x103f34e20> with deadline=24.236814083 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x103f05a60>>; now=9.236814083; delay=15.0
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x103f05b50>>
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(12, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x103f05b50>>)
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(12, _) added handler Wr
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57683, 0, 0)>.
2025-07-12 23:52:55 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57683, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57683, 0, 0)>
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(12)
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(12) removed handler
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x103f34c70> with deadline=19.236691874999998 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x103f05a60>>
2025-07-12 23:52:55 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:52:55 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x103f34e20> with deadline=24.236814083 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x103f05a60>>
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:52:55 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x103f34f40>>
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x103f97af0> with deadline=19.242262500000002 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x103f34f10>>; now=9.2422625; delay=10.0
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x103f97c10> with deadline=24.242347416 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x103f34f10>>; now=9.242347416; delay=15.0
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x103f34f40>>
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(12, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x103f34f40>>)
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(12, _) added handler Wr
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57684)>.
2025-07-12 23:52:55 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57684)>; error=61 (Connection refused)
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57684)>
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(12)
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(12) removed handler
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x103f97af0> with deadline=19.242262500000002 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x103f34f10>>
2025-07-12 23:52:55 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:52:55 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:52:55 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x103f97c10> with deadline=24.242347416 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x103f34f10>>
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:52:55 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:52:55 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:52:55 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:52:55 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:52:55 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:52:55 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:52:55 [INFO] peoples_coin: All blueprints registered.
2025-07-12 23:52:55 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-12 23:52:55 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-12 23:52:55 [INFO] cognitive_system: üß† Sending stop signal to cognitive background loop...
2025-07-12 23:52:55 [INFO] cognitive_system: üß† Cognitive background loop stopped.
2025-07-12 23:52:55 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-12 23:52:55 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-12 23:52:55 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-12 23:58:39 [INFO] peoples_coin: Creating main Flask application...
2025-07-12 23:58:39 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-12 23:58:39 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-12 23:58:39 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-12 23:58:39 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-12 23:58:39 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-12 23:58:39 [DEBUG] google.auth._default: Cloud SDK credentials not found on disk; not using them
2025-07-12 23:58:48 [WARNING] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client failed to initialize: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-07-12 23:58:48 [INFO] cognitive_system: üêá Starting RabbitMQ consumer loop.
2025-07-12 23:58:48 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-12 23:58:48 [INFO] cognitive_system: üß† Cognitive System initialized.
2025-07-12 23:58:48 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-12 23:58:48 [INFO] peoples_coin.consensus: Consensus system configured.
2025-07-12 23:58:48 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized and ready to start.
2025-07-12 23:58:48 [INFO] peoples_coin: All systems initialized.
2025-07-12 23:58:48 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x105f41970>
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x105f41dc0> with deadline=9.565033791 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x105f41970>>, first=True); now=9.565033791; delay=0
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x10599d160> with deadline=9.565977375 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x105f41970>>; now=9.565977375; delay=0
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x105f326d0>>
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x105f326d0>>
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:58:48 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x105f329a0>>
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x105f62820> with deadline=19.569994583 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105f327f0>>; now=9.569994583; delay=10.0
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x105f62700> with deadline=24.570170916000002 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105f327f0>>; now=9.570170916; delay=15.0
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x105f329a0>>
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x105f329a0>>)
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57701, 0, 0)>.
2025-07-12 23:58:48 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57701, 0, 0)>; error=61 (Connection refused)
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57701, 0, 0)>
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x105f62820> with deadline=19.569994583 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105f327f0>>
2025-07-12 23:58:48 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-12 23:58:48 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x105f62700> with deadline=24.570170916000002 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105f327f0>>
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:58:48 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x105f62880>>
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x105fc8160> with deadline=19.573821708 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105f62850>>; now=9.573821708; delay=10.0
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x105fc8220> with deadline=24.57390675 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105f62850>>; now=9.57390675; delay=15.0
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x105f62880>>
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(11, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x105f62880>>)
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(11, _) added handler Wr
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57702)>.
2025-07-12 23:58:48 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57702)>; error=61 (Connection refused)
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=11, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57702)>
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(11)
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(11) removed handler
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x105fc8160> with deadline=19.573821708 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105f62850>>
2025-07-12 23:58:48 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-12 23:58:48 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:58:48 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x105fc8220> with deadline=24.57390675 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105f62850>>
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-12 23:58:48 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-12 23:58:48 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-12 23:58:48 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:58:48 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-12 23:58:48 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-12 23:58:48 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-12 23:58:49 [INFO] peoples_coin: All blueprints registered.
2025-07-12 23:58:49 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-12 23:58:49 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-12 23:58:49 [INFO] cognitive_system: üß† Sending stop signal to cognitive background loop...
2025-07-12 23:58:49 [INFO] cognitive_system: üß† Cognitive background loop stopped.
2025-07-12 23:58:49 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-12 23:58:49 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-12 23:58:49 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-13 00:24:45 [INFO] peoples_coin: Creating main Flask application...
2025-07-13 00:24:45 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 00:24:45 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 00:24:45 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 00:24:45 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-13 00:24:45 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-13 00:24:45 [DEBUG] google.auth._default: Cloud SDK credentials not found on disk; not using them
2025-07-13 00:24:54 [WARNING] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client failed to initialize: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-07-13 00:24:54 [INFO] cognitive_system: üêá Starting RabbitMQ consumer loop.
2025-07-13 00:24:54 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: Using KQueuePoller
2025-07-13 00:24:54 [INFO] cognitive_system: üß† Cognitive System initialized.
2025-07-13 00:24:54 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 00:24:54 [INFO] peoples_coin.consensus: Consensus system configured.
2025-07-13 00:24:54 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized and ready to start.
2025-07-13 00:24:54 [INFO] peoples_coin: All systems initialized.
2025-07-13 00:24:54 [DEBUG] pika.adapters.base_connection: Created default connection workflow <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x105c95eb0>
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.connection_workflow: Starting AMQP Connection workflow asynchronously.
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x105c95f10> with deadline=9.123551041 and callback=functools.partial(<bound method AMQPConnectionWorkflow._start_new_cycle_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x105c95eb0>>, first=True); now=9.123551041; delay=0
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.connection_workflow: Beginning a new AMQP connection workflow cycle; attempts remaining after this: 0
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x1056f6100> with deadline=9.124064166 and callback=<bound method AMQPConnectionWorkflow._try_next_config_async of <pika.adapters.utils.connection_workflow.AMQPConnectionWorkflow object at 0x105c95eb0>>; now=9.124064166; delay=0
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: 'localhost':5672
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x105c857c0>>
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AddressResolver._dispatch_result of <pika.adapters.utils.selector_ioloop_adapter._AddressResolver object at 0x105c857c0>>
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: Invoking asynchronous getaddrinfo() completion callback; host='localhost'
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.connection_workflow: getaddrinfo returned 2 records
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 00:24:54 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x105cb2ca0>>
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x105cb2b50> with deadline=19.125978625000002 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105cb23d0>>; now=9.125978625; delay=10.0
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x105cb2d30> with deadline=24.126064 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105cb23d0>>; now=9.126064; delay=15.0
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x105cb2ca0>>
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(12, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x105cb2ca0>>)
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(12, _) added handler Wr
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57723, 0, 0)>.
2025-07-13 00:24:54 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57723, 0, 0)>; error=61 (Connection refused)
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 57723, 0, 0)>
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(12)
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(12) removed handler
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x105cb2b50> with deadline=19.125978625000002 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105cb23d0>>
2025-07-13 00:24:54 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 00:24:54 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x105cb2d30> with deadline=24.126064 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105cb23d0>>
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.connection_workflow: Attempting to connect using address record (<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-13 00:24:54 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: add_callback_threadsafe: added callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x105d1d070>>
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x105d1d190> with deadline=19.128156791000002 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105cb2d60>>; now=9.128156791; delay=10.0
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: call_later: added timeout <pika.adapters.select_connection._Timeout object at 0x105d1d220> with deadline=24.128226541 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105cb2d60>>; now=9.128226541; delay=15.0
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: process_timeouts: invoking callback=<bound method _AsyncSocketConnector._start_async of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x105d1d070>>
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.set_writer(12, <bound method _AsyncSocketConnector._on_writable of <pika.adapters.utils.io_services_utils._AsyncSocketConnector object at 0x105d1d070>>)
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: set_writer(12, _) added handler Wr
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.io_services_utils: Connection-establishment is in progress for <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57724)>.
2025-07-13 00:24:54 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57724)>; error=61 (Connection refused)
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.io_services_utils: _AsyncSocketConnector._report_completion(ConnectionRefusedError(61, 'Connection refused')); <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 57724)>
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: SelectorIOServicesAdapter.remove_writer(12)
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.selector_ioloop_adapter: remove_writer(12) removed handler
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x105d1d190> with deadline=19.128156791000002 and callback=<bound method AMQPConnector._on_tcp_connection_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105cb2d60>>
2025-07-13 00:24:54 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-13 00:24:54 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 00:24:54 [DEBUG] pika.adapters.select_connection: remove_timeout: removing timeout <pika.adapters.select_connection._Timeout object at 0x105d1d220> with deadline=24.128226541 and callback=<bound method AMQPConnector._on_overall_timeout of <pika.adapters.utils.connection_workflow.AMQPConnector object at 0x105cb2d60>>
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.connection_workflow: Connection attempt completed with AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_resolved_address: continuing with next config.
2025-07-13 00:24:54 [DEBUG] pika.adapters.utils.connection_workflow: _try_next_config_async: starting a new cycle.
2025-07-13 00:24:54 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-13 00:24:54 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 00:24:54 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 00:24:54 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-13 00:24:54 [ERROR] cognitive_system: üêá Consumer connection failed: . Retrying in 10 seconds...
2025-07-13 00:24:54 [INFO] peoples_coin: All blueprints registered.
2025-07-13 00:24:54 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 00:24:54 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-13 00:24:54 [INFO] cognitive_system: üß† Sending stop signal to cognitive background loop...
2025-07-13 00:24:54 [INFO] cognitive_system: üß† Cognitive background loop stopped.
2025-07-13 00:24:54 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-13 00:24:54 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-13 00:24:54 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-13 00:30:36 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 00:30:36 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 00:30:36 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 00:30:36 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 00:30:36 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-13 00:30:36 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-13 00:30:36 [DEBUG] google.auth._default: Cloud SDK credentials not found on disk; not using them
2025-07-13 00:30:45 [WARNING] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client failed to initialize: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-07-13 00:30:45 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 00:30:45 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 00:30:45 [INFO] peoples_coin.consensus: Consensus system configured.
2025-07-13 00:30:45 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized and ready to start.
2025-07-13 00:30:45 [INFO] peoples_coin: All systems initialized.
2025-07-13 00:30:45 [INFO] peoples_coin: All blueprints registered.
2025-07-13 00:30:45 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 00:30:45 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-13 00:30:45 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-13 00:30:45 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-13 00:30:45 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-13 00:44:37 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 00:44:37 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 00:44:37 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 00:44:37 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 00:44:37 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-13 00:44:37 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-13 00:44:37 [DEBUG] google.auth._default: Cloud SDK credentials not found on disk; not using them
2025-07-13 00:44:46 [WARNING] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client failed to initialize: Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
2025-07-13 00:44:46 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 00:44:46 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 00:44:46 [INFO] peoples_coin.consensus: Consensus system configured.
2025-07-13 00:44:46 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized and ready to start.
2025-07-13 00:44:46 [INFO] peoples_coin: All systems initialized.
2025-07-13 00:44:46 [INFO] peoples_coin: All blueprints registered.
2025-07-13 00:44:46 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 00:44:46 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-13 00:44:46 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-13 00:44:46 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-13 00:44:46 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-13 13:32:06 [INFO] alembic.runtime.migration: Context impl SQLiteImpl.
2025-07-13 13:32:06 [INFO] alembic.runtime.migration: Will assume non-transactional DDL.
2025-07-13 13:32:06 [INFO] alembic.runtime.migration: Running upgrade  -> 90e53ab6e209, Create initial tables and update GoodwillAction for AILEE
2025-07-13 13:52:27 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 13:52:27 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 13:52:27 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 13:52:27 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 13:52:27 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-13 13:52:27 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 13:52:27 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 13:52:27 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-13 13:52:27 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-13 13:52:27 [INFO] peoples_coin: All systems initialized.
2025-07-13 13:52:27 [INFO] peoples_coin: All blueprints registered.
2025-07-13 13:52:27 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 13:52:27 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Starting worker pool...
2025-07-13 13:52:27 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-13 13:52:27 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Worker thread started.
2025-07-13 13:52:27 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker tasks submitted to the pool.
2025-07-13 13:52:27 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-13 13:52:27 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 13:52:27 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=14, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 58647, 0, 0)>; error=61 (Connection refused)
2025-07-13 13:52:27 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 13:52:27 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:27 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 13:52:27 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 58648)>; error=61 (Connection refused)
2025-07-13 13:52:27 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-13 13:52:27 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:27 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-13 13:52:27 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:27 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:27 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-13 13:52:27 [INFO] werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.0.137:5000
2025-07-13 13:52:27 [INFO] werkzeug: [33mPress CTRL+C to quit[0m
2025-07-13 13:52:37 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 13:52:37 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 58651, 0, 0)>; error=61 (Connection refused)
2025-07-13 13:52:37 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 13:52:37 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:37 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 13:52:37 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 58652)>; error=61 (Connection refused)
2025-07-13 13:52:37 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-13 13:52:37 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:37 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-13 13:52:37 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:37 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:37 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-13 13:52:47 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 13:52:47 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 58655, 0, 0)>; error=61 (Connection refused)
2025-07-13 13:52:47 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 13:52:47 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:47 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 13:52:47 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 58656)>; error=61 (Connection refused)
2025-07-13 13:52:47 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-13 13:52:47 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:47 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-13 13:52:47 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:47 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:47 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-13 13:52:57 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 13:52:57 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 58659, 0, 0)>; error=61 (Connection refused)
2025-07-13 13:52:57 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 13:52:57 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:57 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 13:52:57 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 58660)>; error=61 (Connection refused)
2025-07-13 13:52:57 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-13 13:52:57 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:57 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-13 13:52:57 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:57 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:52:57 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-13 13:53:07 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 13:53:07 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 58663, 0, 0)>; error=61 (Connection refused)
2025-07-13 13:53:07 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 13:53:07 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:53:07 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 13:53:07 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 58664)>; error=61 (Connection refused)
2025-07-13 13:53:07 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-13 13:53:07 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:53:07 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-13 13:53:07 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:53:07 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:53:07 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-13 13:53:17 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 13:53:17 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 58667, 0, 0)>; error=61 (Connection refused)
2025-07-13 13:53:17 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 13:53:17 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:53:17 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 13:53:17 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 58668)>; error=61 (Connection refused)
2025-07-13 13:53:17 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET: 2>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('127.0.0.1', 5672))
2025-07-13 13:53:17 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:53:17 [ERROR] pika.adapters.utils.connection_workflow: AMQP connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused').
2025-07-13 13:53:17 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting failure: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:53:17 [ERROR] pika.adapters.blocking_connection: Connection workflow failed: AMQPConnectionWorkflowFailed: 2 exceptions in all; last exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused'); first exception - AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:53:17 [ERROR] pika.adapters.blocking_connection: Error in _create_connection().
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/venv/lib/python3.9/site-packages/pika/adapters/blocking_connection.py", line 451, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.AMQPConnectionError
2025-07-13 13:53:18 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-13 13:53:18 [INFO] cognitive_system: üß† Sending stop signal to cognitive background loop...
2025-07-13 13:53:18 [INFO] cognitive_system: üß† Cognitive background loop stopped.
2025-07-13 13:53:18 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-13 13:53:18 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-13 13:53:18 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-13 13:55:23 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 13:55:23 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 13:55:23 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 13:55:23 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 13:55:23 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-13 13:55:23 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 13:55:23 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 13:55:23 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-13 13:55:23 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-13 13:55:23 [INFO] peoples_coin: All systems initialized.
2025-07-13 13:55:23 [INFO] peoples_coin: All blueprints registered.
2025-07-13 13:55:23 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 13:55:23 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Starting worker pool...
2025-07-13 13:55:23 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-13 13:55:23 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Worker thread started.
2025-07-13 13:55:23 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker tasks submitted to the pool.
2025-07-13 13:55:23 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-13 13:55:23 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 13:55:23 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 58739, 0, 0)>; error=61 (Connection refused)
2025-07-13 13:55:23 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 13:55:23 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 13:55:23 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 13:55:23 [INFO] pika.adapters.utils.io_services_utils: Socket connected: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 58740), raddr=('127.0.0.1', 5672)>
2025-07-13 13:55:23 [INFO] pika.adapters.utils.connection_workflow: Streaming transport linked up: (<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x1034cc4f0>, _StreamingProtocolShim: <SelectConnection PROTOCOL transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x1034cc4f0> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>).
2025-07-13 13:55:23 [INFO] werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.0.137:5000
2025-07-13 13:55:23 [INFO] werkzeug: [33mPress CTRL+C to quit[0m
2025-07-13 13:55:23 [INFO] pika.adapters.utils.connection_workflow: AMQPConnector - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x1034cc4f0> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 13:55:23 [INFO] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x1034cc4f0> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 13:55:23 [INFO] pika.adapters.blocking_connection: Connection workflow succeeded: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x1034cc4f0> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 13:55:23 [INFO] pika.adapters.blocking_connection: Created channel=1
2025-07-13 13:55:23 [INFO] pika.adapters.blocking_connection: Created new queue consumer generator <_QueueConsumerGeneratorInfo params=('cognitive_events', False, False) consumer_tag='ctag1.2df9c593c985470c95fd7040cbb1ba14'>
2025-07-13 14:03:04 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 14:03:04 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 14:03:04 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 14:03:04 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 14:03:04 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-13 14:03:04 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 14:03:04 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 14:03:04 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-13 14:03:04 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-13 14:03:04 [INFO] peoples_coin: All systems initialized.
2025-07-13 14:03:04 [INFO] peoples_coin: All blueprints registered.
2025-07-13 14:03:04 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 14:03:04 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Starting worker pool...
2025-07-13 14:03:04 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-13 14:03:04 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-13 14:03:04 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker tasks submitted to the pool.
2025-07-13 14:03:04 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-13 14:03:04 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-13 14:03:04 [INFO] cognitive_system: üß† Sending stop signal to cognitive background loop...
2025-07-13 14:03:04 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 14:03:04 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=9, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 58772, 0, 0)>; error=61 (Connection refused)
2025-07-13 14:03:04 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 14:03:04 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 14:03:04 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 14:03:04 [INFO] pika.adapters.utils.io_services_utils: Socket connected: <socket.socket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 58773), raddr=('127.0.0.1', 5672)>
2025-07-13 14:03:04 [INFO] pika.adapters.utils.connection_workflow: Streaming transport linked up: (<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103aeb280>, _StreamingProtocolShim: <SelectConnection PROTOCOL transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103aeb280> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>).
2025-07-13 14:03:04 [INFO] pika.adapters.utils.connection_workflow: AMQPConnector - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103aeb280> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 14:03:04 [INFO] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103aeb280> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 14:03:04 [INFO] pika.adapters.blocking_connection: Connection workflow succeeded: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103aeb280> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 14:03:04 [INFO] pika.adapters.blocking_connection: Created channel=1
2025-07-13 14:03:04 [INFO] pika.adapters.blocking_connection: Created new queue consumer generator <_QueueConsumerGeneratorInfo params=('cognitive_events', False, False) consumer_tag='ctag1.c509e085142142c0b744306fc4bbe708'>
2025-07-13 14:03:14 [INFO] cognitive_system: üß† Cognitive background loop stopped.
2025-07-13 14:03:14 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-13 14:03:14 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-13 14:03:14 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-13 14:04:12 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 14:04:12 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 14:04:12 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 14:04:12 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 14:04:12 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-13 14:04:12 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 14:04:12 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 14:04:12 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-13 14:04:12 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-13 14:04:12 [INFO] peoples_coin: All systems initialized.
2025-07-13 14:04:12 [INFO] peoples_coin: All blueprints registered.
2025-07-13 14:04:12 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 14:04:12 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Starting worker pool...
2025-07-13 14:04:12 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-13 14:04:12 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-13 14:04:12 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker tasks submitted to the pool.
2025-07-13 14:04:12 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-13 14:04:12 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-13 14:04:12 [INFO] cognitive_system: üß† Sending stop signal to cognitive background loop...
2025-07-13 14:04:12 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 14:04:12 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=8, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 58782, 0, 0)>; error=61 (Connection refused)
2025-07-13 14:04:12 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 14:04:12 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 14:04:12 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 14:04:12 [INFO] pika.adapters.utils.io_services_utils: Socket connected: <socket.socket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 58783), raddr=('127.0.0.1', 5672)>
2025-07-13 14:04:12 [INFO] pika.adapters.utils.connection_workflow: Streaming transport linked up: (<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x105ac4880>, _StreamingProtocolShim: <SelectConnection PROTOCOL transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x105ac4880> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>).
2025-07-13 14:04:12 [INFO] pika.adapters.utils.connection_workflow: AMQPConnector - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x105ac4880> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 14:04:12 [INFO] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x105ac4880> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 14:04:12 [INFO] pika.adapters.blocking_connection: Connection workflow succeeded: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x105ac4880> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 14:04:12 [INFO] pika.adapters.blocking_connection: Created channel=1
2025-07-13 14:04:12 [INFO] pika.adapters.blocking_connection: Created new queue consumer generator <_QueueConsumerGeneratorInfo params=('cognitive_events', False, False) consumer_tag='ctag1.dbb40cc365e74476adf4dcd0a7127b97'>
2025-07-13 14:04:22 [INFO] cognitive_system: üß† Cognitive background loop stopped.
2025-07-13 14:04:22 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-13 14:04:22 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-13 14:04:22 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-13 14:05:37 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 14:05:37 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 14:05:37 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 14:05:37 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 14:05:37 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-13 14:05:37 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 14:05:37 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 14:05:37 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-13 14:05:37 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-13 14:05:37 [INFO] peoples_coin: All systems initialized.
2025-07-13 14:05:37 [INFO] peoples_coin: All blueprints registered.
2025-07-13 14:05:37 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 14:05:37 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Starting worker pool...
2025-07-13 14:05:37 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-13 14:05:37 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-13 14:05:37 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker tasks submitted to the pool.
2025-07-13 14:05:37 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-13 14:05:37 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 14:05:37 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=12, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 58794, 0, 0)>; error=61 (Connection refused)
2025-07-13 14:05:37 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 14:05:37 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 14:05:37 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 14:05:37 [INFO] pika.adapters.utils.io_services_utils: Socket connected: <socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 58795), raddr=('127.0.0.1', 5672)>
2025-07-13 14:05:37 [INFO] pika.adapters.utils.connection_workflow: Streaming transport linked up: (<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x107901820>, _StreamingProtocolShim: <SelectConnection PROTOCOL transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x107901820> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>).
2025-07-13 14:05:37 [INFO] werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.0.137:5000
2025-07-13 14:05:37 [INFO] werkzeug: [33mPress CTRL+C to quit[0m
2025-07-13 14:05:37 [INFO] pika.adapters.utils.connection_workflow: AMQPConnector - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x107901820> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 14:05:37 [INFO] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x107901820> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 14:05:37 [INFO] pika.adapters.blocking_connection: Connection workflow succeeded: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x107901820> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 14:05:37 [INFO] pika.adapters.blocking_connection: Created channel=1
2025-07-13 14:05:37 [INFO] pika.adapters.blocking_connection: Created new queue consumer generator <_QueueConsumerGeneratorInfo params=('cognitive_events', False, False) consumer_tag='ctag1.ae9215f4b7874c5e8ec1e323d4bf3a33'>
2025-07-13 14:09:48 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 14:09:48] "GET /metabolic/status HTTP/1.1" 200 -
2025-07-13 14:11:31 [INFO] peoples_coin.systems.metabolic_system: üì• Received goodwill submission request.
2025-07-13 14:11:31 [INFO] peoples_coin.systems.metabolic_system: ‚úÖ Goodwill action schema validated for user_id: user_12345, action_type: federated_learning_update
2025-07-13 14:11:31 [ERROR] peoples_coin.systems.metabolic_system: üí• Unexpected error during goodwill submission: get_session_scope() missing 1 required positional argument: 'db_instance'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/metabolic_system.py", line 116, in submit_goodwill
    with get_session_scope() as session:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 244, in helper
    return _GeneratorContextManager(func, args, kwds)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 87, in __init__
    self.gen = func(*args, **kwds)
TypeError: get_session_scope() missing 1 required positional argument: 'db_instance'
2025-07-13 14:11:31 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 14:11:31] "[35m[1mPOST /metabolic/submit_goodwill HTTP/1.1[0m" 500 -
2025-07-13 14:21:54 [INFO] alembic.runtime.migration: Context impl SQLiteImpl.
2025-07-13 14:21:54 [INFO] alembic.runtime.migration: Will assume non-transactional DDL.
2025-07-13 14:23:00 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 14:23:00 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 14:23:00 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 14:23:00 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 14:23:00 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-13 14:23:00 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 14:23:00 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 14:23:00 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-13 14:23:00 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-13 14:23:00 [INFO] peoples_coin: All systems initialized.
2025-07-13 14:23:01 [INFO] peoples_coin: All blueprints registered.
2025-07-13 14:23:01 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 14:23:01 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Starting worker pool...
2025-07-13 14:23:01 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-13 14:23:01 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Worker thread started.
2025-07-13 14:23:01 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker tasks submitted to the pool.
2025-07-13 14:23:01 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-13 14:23:01 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 14:23:01 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=14, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 58864, 0, 0)>; error=61 (Connection refused)
2025-07-13 14:23:01 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 14:23:01 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 14:23:01 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 14:23:01 [INFO] pika.adapters.utils.io_services_utils: Socket connected: <socket.socket fd=14, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 58865), raddr=('127.0.0.1', 5672)>
2025-07-13 14:23:01 [INFO] pika.adapters.utils.connection_workflow: Streaming transport linked up: (<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103564bb0>, _StreamingProtocolShim: <SelectConnection PROTOCOL transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103564bb0> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>).
2025-07-13 14:23:01 [INFO] werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.0.137:5000
2025-07-13 14:23:01 [INFO] werkzeug: [33mPress CTRL+C to quit[0m
2025-07-13 14:23:01 [INFO] pika.adapters.utils.connection_workflow: AMQPConnector - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103564bb0> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 14:23:01 [INFO] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103564bb0> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 14:23:01 [INFO] pika.adapters.blocking_connection: Connection workflow succeeded: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103564bb0> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 14:23:01 [INFO] pika.adapters.blocking_connection: Created channel=1
2025-07-13 14:23:01 [INFO] pika.adapters.blocking_connection: Created new queue consumer generator <_QueueConsumerGeneratorInfo params=('cognitive_events', False, False) consumer_tag='ctag1.55c5320f390f4594b72b6d3b7bb2e06b'>
2025-07-13 14:24:31 [INFO] peoples_coin.systems.metabolic_system: üì• Received goodwill submission request.
2025-07-13 14:24:31 [INFO] peoples_coin.systems.metabolic_system: ‚úÖ Goodwill action schema validated for user_id: user_12345, action_type: federated_learning_update
2025-07-13 14:24:31 [ERROR] peoples_coin.systems.metabolic_system: üí• Unexpected error during goodwill submission: get_session_scope() missing 1 required positional argument: 'db_instance'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/metabolic_system.py", line 116, in submit_goodwill
    with get_session_scope() as session:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 244, in helper
    return _GeneratorContextManager(func, args, kwds)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 87, in __init__
    self.gen = func(*args, **kwds)
TypeError: get_session_scope() missing 1 required positional argument: 'db_instance'
2025-07-13 14:24:31 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 14:24:31] "[35m[1mPOST /metabolic/submit_goodwill HTTP/1.1[0m" 500 -
2025-07-13 14:28:36 [INFO] peoples_coin.systems.metabolic_system: üì• Received goodwill submission request.
2025-07-13 14:28:36 [INFO] peoples_coin.systems.metabolic_system: ‚úÖ Goodwill action schema validated for user_id: user_12345, action_type: federated_learning_update
2025-07-13 14:28:36 [ERROR] peoples_coin.systems.metabolic_system: üí• Unexpected error during goodwill submission: get_session_scope() missing 1 required positional argument: 'db_instance'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/metabolic_system.py", line 116, in submit_goodwill
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 244, in helper
    return _GeneratorContextManager(func, args, kwds)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 87, in __init__
    self.gen = func(*args, **kwds)
TypeError: get_session_scope() missing 1 required positional argument: 'db_instance'
2025-07-13 14:28:36 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 14:28:36] "[35m[1mPOST /metabolic/submit_goodwill HTTP/1.1[0m" 500 -
2025-07-13 14:28:57 [INFO] peoples_coin.systems.metabolic_system: üì• Received goodwill submission request.
2025-07-13 14:28:57 [INFO] peoples_coin.systems.metabolic_system: ‚úÖ Goodwill action schema validated for user_id: user_67890, action_type: anomaly_detection_inference
2025-07-13 14:28:57 [ERROR] peoples_coin.systems.metabolic_system: üí• Unexpected error during goodwill submission: get_session_scope() missing 1 required positional argument: 'db_instance'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/metabolic_system.py", line 116, in submit_goodwill
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 244, in helper
    return _GeneratorContextManager(func, args, kwds)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 87, in __init__
    self.gen = func(*args, **kwds)
TypeError: get_session_scope() missing 1 required positional argument: 'db_instance'
2025-07-13 14:28:57 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 14:28:57] "[35m[1mPOST /metabolic/submit_goodwill HTTP/1.1[0m" 500 -
2025-07-13 14:31:36 [INFO] peoples_coin.systems.metabolic_system: üì• Received goodwill submission request.
2025-07-13 14:31:36 [INFO] peoples_coin.systems.metabolic_system: ‚úÖ Goodwill action schema validated for user_id: user_12345, action_type: federated_learning_update
2025-07-13 14:31:36 [ERROR] peoples_coin.systems.metabolic_system: üí• Unexpected error during goodwill submission: get_session_scope() missing 1 required positional argument: 'db_instance'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/metabolic_system.py", line 116, in submit_goodwill
    except Exception as e:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 244, in helper
    return _GeneratorContextManager(func, args, kwds)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 87, in __init__
    self.gen = func(*args, **kwds)
TypeError: get_session_scope() missing 1 required positional argument: 'db_instance'
2025-07-13 14:31:36 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 14:31:36] "[35m[1mPOST /metabolic/submit_goodwill HTTP/1.1[0m" 500 -
2025-07-13 14:34:21 [INFO] peoples_coin.systems.metabolic_system: üì• Received goodwill submission request.
2025-07-13 14:34:21 [INFO] peoples_coin.systems.metabolic_system: ‚úÖ Goodwill action schema validated for user_id: user_12345, action_type: federated_learning_update
2025-07-13 14:34:21 [ERROR] peoples_coin.systems.metabolic_system: üí• Unexpected error during goodwill submission: get_session_scope() missing 1 required positional argument: 'db_instance'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/metabolic_system.py", line 116, in submit_goodwill
    except Exception as e:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 244, in helper
    return _GeneratorContextManager(func, args, kwds)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 87, in __init__
    self.gen = func(*args, **kwds)
TypeError: get_session_scope() missing 1 required positional argument: 'db_instance'
2025-07-13 14:34:21 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 14:34:21] "[35m[1mPOST /metabolic/submit_goodwill HTTP/1.1[0m" 500 -
2025-07-13 14:40:10 [INFO] peoples_coin.systems.metabolic_system: üì• Received goodwill submission request.
2025-07-13 14:40:10 [INFO] peoples_coin.systems.metabolic_system: ‚úÖ Goodwill action schema validated for user_id: user_12345, action_type: federated_learning_update
2025-07-13 14:40:10 [ERROR] peoples_coin.systems.metabolic_system: üí• Unexpected error during goodwill submission: get_session_scope() missing 1 required positional argument: 'db_instance'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/metabolic_system.py", line 116, in submit_goodwill
    except Exception as e:
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 244, in helper
    return _GeneratorContextManager(func, args, kwds)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 87, in __init__
    self.gen = func(*args, **kwds)
TypeError: get_session_scope() missing 1 required positional argument: 'db_instance'
2025-07-13 14:40:10 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 14:40:10] "[35m[1mPOST /metabolic/submit_goodwill HTTP/1.1[0m" 500 -
2025-07-13 14:45:15 [INFO] peoples_coin.systems.metabolic_system: üì• Received goodwill submission request.
2025-07-13 14:45:15 [INFO] peoples_coin.systems.metabolic_system: ‚úÖ Goodwill action schema validated for user_id: user_12345, action_type: federated_learning_update
2025-07-13 14:45:15 [ERROR] peoples_coin.systems.metabolic_system: üí• Unexpected error during goodwill submission: get_session_scope() missing 1 required positional argument: 'db_instance'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/metabolic_system.py", line 116, in submit_goodwill
    logger.warning(f"üö´ Pydantic validation failed. Errors: {ve.errors()}")
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 244, in helper
    return _GeneratorContextManager(func, args, kwds)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 87, in __init__
    self.gen = func(*args, **kwds)
TypeError: get_session_scope() missing 1 required positional argument: 'db_instance'
2025-07-13 14:45:15 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 14:45:15] "[35m[1mPOST /metabolic/submit_goodwill HTTP/1.1[0m" 500 -
2025-07-13 14:46:23 [INFO] peoples_coin.systems.metabolic_system: üì• Received goodwill submission request.
2025-07-13 14:46:23 [INFO] peoples_coin.systems.metabolic_system: ‚úÖ Goodwill action schema validated for user_id: user_12345, action_type: federated_learning_update
2025-07-13 14:46:23 [ERROR] peoples_coin.systems.metabolic_system: üí• Unexpected error during goodwill submission: get_session_scope() missing 1 required positional argument: 'db_instance'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/systems/metabolic_system.py", line 116, in submit_goodwill
    logger.warning(f"üö´ Pydantic validation failed. Errors: {ve.errors()}")
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 244, in helper
    return _GeneratorContextManager(func, args, kwds)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 87, in __init__
    self.gen = func(*args, **kwds)
TypeError: get_session_scope() missing 1 required positional argument: 'db_instance'
2025-07-13 14:46:23 [INFO] werkzeug: 10.0.0.137 - - [13/Jul/2025 14:46:23] "[35m[1mPOST /metabolic/submit_goodwill HTTP/1.1[0m" 500 -
2025-07-13 14:48:12 [INFO] alembic.runtime.migration: Context impl SQLiteImpl.
2025-07-13 14:48:12 [INFO] alembic.runtime.migration: Will assume non-transactional DDL.
2025-07-13 14:56:52 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 14:56:52 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 14:56:52 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 14:56:52 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 14:56:52 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-13 14:56:52 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 14:56:52 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 14:56:52 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-13 14:56:52 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-13 14:56:52 [INFO] peoples_coin: All systems initialized.
2025-07-13 14:56:52 [INFO] peoples_coin: All blueprints registered.
2025-07-13 14:56:52 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 14:56:52 [INFO] src.peoples_coin.systems.endocrine_system: EndocrineSystem instance created.
2025-07-13 14:56:52 [INFO] src.peoples_coin.systems.circulatory_system: CirculatorySystem instance created.
2025-07-13 14:56:52 [INFO] src.peoples_coin.consensus: Consensus system instance created.
2025-07-13 14:56:53 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 14:56:53 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 14:56:53 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 14:56:53 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 14:56:53 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-13 14:56:53 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-13 14:56:53 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-13 14:56:53 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-13 14:56:53 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-13 14:56:53 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 14:56:53 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 14:56:53 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-13 14:56:53 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-13 14:56:53 [INFO] peoples_coin: All systems initialized.
2025-07-13 14:56:53 [INFO] peoples_coin: All blueprints registered.
2025-07-13 14:56:53 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 14:56:53 [INFO] src.peoples_coin.systems.endocrine_system: EndocrineSystem instance created.
2025-07-13 14:56:53 [INFO] src.peoples_coin.systems.circulatory_system: CirculatorySystem instance created.
2025-07-13 14:56:53 [INFO] src.peoples_coin.consensus: Consensus system instance created.
2025-07-13 15:03:16 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 15:03:16 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 15:03:16 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 15:03:16 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 15:03:16 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-13 15:03:16 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-13 15:03:16 [DEBUG] google.auth._default: Checking None for explicit credentials as part of auth process...
2025-07-13 15:03:16 [DEBUG] google.auth._default: Checking Cloud SDK credentials as part of auth process...
2025-07-13 15:03:16 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-13 15:03:16 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 15:03:16 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 15:03:16 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-13 15:03:16 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-13 15:03:16 [INFO] peoples_coin: All systems initialized.
2025-07-13 15:03:16 [INFO] peoples_coin: All blueprints registered.
2025-07-13 15:03:16 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 15:03:16 [INFO] src.peoples_coin.systems.endocrine_system: EndocrineSystem instance created.
2025-07-13 15:03:16 [INFO] src.peoples_coin.systems.circulatory_system: CirculatorySystem instance created.
2025-07-13 15:03:16 [INFO] src.peoples_coin.consensus: Consensus system instance created.
2025-07-13 15:03:40 [INFO] alembic.runtime.migration: Context impl SQLiteImpl.
2025-07-13 15:03:40 [INFO] alembic.runtime.migration: Will assume non-transactional DDL.
2025-07-13 15:03:40 [INFO] alembic.autogenerate.compare: Detected added column 'goodwill_actions.initial_model_state_v0'
2025-07-13 15:03:40 [INFO] alembic.autogenerate.compare: Detected added column 'goodwill_actions.expected_workload_intensity_w0'
2025-07-13 15:03:40 [INFO] alembic.autogenerate.compare: Detected added column 'goodwill_actions.client_compute_estimate'
2025-07-13 15:03:41 [INFO] alembic.runtime.migration: Context impl SQLiteImpl.
2025-07-13 15:03:41 [INFO] alembic.runtime.migration: Will assume non-transactional DDL.
2025-07-13 15:03:41 [INFO] alembic.runtime.migration: Running upgrade 90e53ab6e209 -> 9fd17fff9321, Add new workload and compute fields to GoodwillAction
2025-07-13 17:13:07 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 17:13:07 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 17:13:07 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 17:13:07 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 17:13:07 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-13 17:13:07 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 17:13:07 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 17:21:37 [INFO] peoples_coin: Creating Flask application instance.
2025-07-13 17:21:37 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-13 17:21:37 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-13 17:21:37 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-13 17:21:38 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-13 17:21:38 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-13 17:21:38 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-13 17:21:38 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-13 17:21:38 [INFO] peoples_coin: All systems initialized.
2025-07-13 17:21:38 [INFO] peoples_coin: All blueprints registered.
2025-07-13 17:21:38 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-13 17:21:38 [INFO] __main__: Starting Endocrine System...
2025-07-13 17:21:38 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Starting worker pool...
2025-07-13 17:21:38 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-13 17:21:38 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Worker thread started.
2025-07-13 17:21:38 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker tasks submitted to the pool.
2025-07-13 17:21:38 [INFO] __main__: Starting Cognitive System background loop...
2025-07-13 17:21:38 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-13 17:21:38 [INFO] __main__: Starting Flask server on 0.0.0.0:5000
2025-07-13 17:21:38 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-13 17:21:38 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 59463, 0, 0)>; error=61 (Connection refused)
2025-07-13 17:21:38 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-13 17:21:38 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-13 17:21:38 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-13 17:21:38 [INFO] pika.adapters.utils.io_services_utils: Socket connected: <socket.socket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 59464), raddr=('127.0.0.1', 5672)>
2025-07-13 17:21:38 [INFO] pika.adapters.utils.connection_workflow: Streaming transport linked up: (<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103e2e280>, _StreamingProtocolShim: <SelectConnection PROTOCOL transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103e2e280> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>).
2025-07-13 17:21:38 [INFO] werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.0.137:5000
2025-07-13 17:21:38 [INFO] werkzeug: [33mPress CTRL+C to quit[0m
2025-07-13 17:21:38 [INFO] pika.adapters.utils.connection_workflow: AMQPConnector - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103e2e280> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 17:21:38 [INFO] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103e2e280> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 17:21:38 [INFO] pika.adapters.blocking_connection: Connection workflow succeeded: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x103e2e280> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-13 17:21:38 [INFO] pika.adapters.blocking_connection: Created channel=1
2025-07-13 17:21:38 [INFO] pika.adapters.blocking_connection: Created new queue consumer generator <_QueueConsumerGeneratorInfo params=('cognitive_events', False, False) consumer_tag='ctag1.3fdab4506bf14d1caf482f53877471ff'>
2025-07-13 17:22:11 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 17:22:11] "[33mGET / HTTP/1.1[0m" 404 -
2025-07-13 17:22:23 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 17:22:23] "GET /health HTTP/1.1" 200 -
2025-07-13 17:23:09 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 17:23:09] "[33mGET / HTTP/1.1[0m" 404 -
2025-07-13 17:29:42 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 17:29:42] "GET /health HTTP/1.1" 200 -
2025-07-13 17:31:26 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 17:31:26] "[33mPOST /nervous/process HTTP/1.1[0m" 404 -
2025-07-13 17:44:10 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 17:44:10] "GET /health HTTP/1.1" 200 -
2025-07-13 17:44:49 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 17:44:49] "[33mGET / HTTP/1.1[0m" 404 -
2025-07-13 17:46:19 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 17:46:19] "[33mPOST /goodwill-actions HTTP/1.1[0m" 404 -
2025-07-13 17:48:49 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 17:48:49] "[33mPOST /goodwill-actions HTTP/1.1[0m" 404 -
2025-07-13 17:51:17 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 17:51:17] "GET /health HTTP/1.1" 200 -
2025-07-13 17:51:27 [INFO] werkzeug: 127.0.0.1 - - [13/Jul/2025 17:51:27] "[33mPOST /goodwill-actions HTTP/1.1[0m" 404 -
2025-07-13 18:44:50 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-13 18:44:50 [INFO] cognitive_system: üß† Sending stop signal to cognitive background loop...
2025-07-13 18:45:00 [INFO] cognitive_system: üß† Cognitive background loop stopped.
2025-07-13 18:45:00 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-13 18:45:00 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Worker thread exiting.
2025-07-13 18:45:00 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread exiting.
2025-07-13 18:45:00 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-13 18:45:00 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-13 18:45:00 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-13 18:45:00 [INFO] cognitive_system: üß† Sending stop signal to cognitive background loop...
2025-07-13 18:45:10 [INFO] cognitive_system: üß† Cognitive background loop stopped.
2025-07-13 18:45:10 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-13 18:45:10 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-13 18:45:10 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-14 08:31:08 [INFO] peoples_coin: Creating Flask application instance.
2025-07-14 08:31:09 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-14 08:31:09 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-14 08:31:09 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-14 08:31:09 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-14 08:31:09 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-14 08:31:09 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-14 08:31:09 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-14 08:31:09 [INFO] peoples_coin: All systems initialized.
2025-07-14 08:31:09 [INFO] peoples_coin.consensus: Consensus system instance created.
2025-07-14 08:37:21 [INFO] peoples_coin: Creating Flask application instance.
2025-07-14 08:37:21 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-14 08:37:21 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-14 08:37:21 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-14 08:37:22 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-14 08:37:22 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-14 08:37:22 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-14 08:37:22 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-14 08:37:22 [INFO] peoples_coin: All systems initialized.
2025-07-14 08:37:22 [INFO] peoples_coin.consensus: Consensus system instance created.
2025-07-14 08:37:22 [INFO] peoples_coin: All blueprints registered.
2025-07-14 08:37:22 [INFO] peoples_coin.consensus: Consensus system instance created.
2025-07-14 08:43:04 [INFO] peoples_coin: Creating Flask application instance.
2025-07-14 08:43:04 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-14 08:43:04 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-14 08:43:04 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-14 08:43:04 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-14 08:43:04 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-14 08:43:04 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-14 08:43:04 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-14 08:43:04 [INFO] peoples_coin: All systems initialized.
2025-07-14 08:43:04 [INFO] peoples_coin: All blueprints registered.
2025-07-14 08:43:04 [INFO] peoples_coin.consensus: Consensus system instance created.
2025-07-14 08:51:38 [INFO] peoples_coin: Creating Flask application instance.
2025-07-14 08:51:38 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-14 08:51:38 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-14 08:51:38 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-14 08:51:38 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-14 08:51:38 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-14 08:51:38 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-14 08:51:38 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-14 08:51:38 [INFO] peoples_coin: All systems initialized.
2025-07-14 08:51:38 [INFO] peoples_coin: All blueprints registered.
2025-07-14 08:51:38 [INFO] peoples_coin.consensus: Consensus system instance created.
2025-07-14 08:51:38 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-14 08:51:38 [INFO] peoples_coin: Consensus system initialized.
2025-07-14 08:51:38 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-14 08:51:38 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-14 08:51:38 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-14 08:51:38 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-14 08:51:38 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-14 08:55:47 [INFO] peoples_coin: Creating Flask application instance.
2025-07-14 08:55:47 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Successfully connected to Redis.
2025-07-14 08:55:47 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-14 08:55:47 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-14 08:55:47 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-14 08:55:47 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-14 08:55:47 [INFO] peoples_coin.systems.circulatory_system: CirculatorySystem initialized and configured.
2025-07-14 08:55:47 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] System initialized with 2 workers and loop delay 5s. Ready to start.
2025-07-14 08:55:47 [INFO] peoples_coin: All systems initialized.
2025-07-14 08:55:47 [INFO] peoples_coin: All blueprints registered.
2025-07-14 08:55:47 [INFO] peoples_coin.consensus: Consensus system instance created.
2025-07-14 08:55:47 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-14 08:55:47 [INFO] peoples_coin: Consensus system initialized.
2025-07-14 08:55:47 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-14 08:55:47 [INFO] __main__: Starting Endocrine System...
2025-07-14 08:55:47 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Starting worker pool...
2025-07-14 08:55:47 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread started.
2025-07-14 08:55:47 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Worker thread started.
2025-07-14 08:55:47 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker tasks submitted to the pool.
2025-07-14 08:55:47 [INFO] __main__: Starting Cognitive System background loop...
2025-07-14 08:55:47 [INFO] cognitive_system: üß† Cognitive background loop started.
2025-07-14 08:55:47 [INFO] __main__: Starting Flask server on 0.0.0.0:5000
2025-07-14 08:55:47 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('::1', 5672, 0, 0)
2025-07-14 08:55:47 [ERROR] pika.adapters.utils.io_services_utils: Socket failed to connect: <socket.socket fd=16, family=AddressFamily.AF_INET6, type=SocketKind.SOCK_STREAM, proto=6, laddr=('::1', 61165, 0, 0)>; error=61 (Connection refused)
2025-07-14 08:55:47 [ERROR] pika.adapters.utils.connection_workflow: TCP Connection attempt failed: ConnectionRefusedError(61, 'Connection refused'); dest=(<AddressFamily.AF_INET6: 30>, <SocketKind.SOCK_STREAM: 1>, 6, '', ('::1', 5672, 0, 0))
2025-07-14 08:55:47 [ERROR] pika.adapters.utils.connection_workflow: AMQPConnector - reporting failure: AMQPConnectorSocketConnectError: ConnectionRefusedError(61, 'Connection refused')
2025-07-14 08:55:47 [INFO] pika.adapters.utils.connection_workflow: Pika version 1.3.2 connecting to ('127.0.0.1', 5672)
2025-07-14 08:55:47 [INFO] pika.adapters.utils.io_services_utils: Socket connected: <socket.socket fd=16, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('127.0.0.1', 61166), raddr=('127.0.0.1', 5672)>
2025-07-14 08:55:47 [INFO] pika.adapters.utils.connection_workflow: Streaming transport linked up: (<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x1082ac490>, _StreamingProtocolShim: <SelectConnection PROTOCOL transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x1082ac490> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>).
2025-07-14 08:55:47 [INFO] werkzeug: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.0.137:5000
2025-07-14 08:55:47 [INFO] werkzeug: [33mPress CTRL+C to quit[0m
2025-07-14 08:55:48 [INFO] pika.adapters.utils.connection_workflow: AMQPConnector - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x1082ac490> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-14 08:55:48 [INFO] pika.adapters.utils.connection_workflow: AMQPConnectionWorkflow - reporting success: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x1082ac490> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-14 08:55:48 [INFO] pika.adapters.blocking_connection: Connection workflow succeeded: <SelectConnection OPEN transport=<pika.adapters.utils.io_services_utils._AsyncPlaintextTransport object at 0x1082ac490> params=<URLParameters host=localhost port=5672 virtual_host=/ ssl=False>>
2025-07-14 08:55:48 [INFO] pika.adapters.blocking_connection: Created channel=1
2025-07-14 08:55:48 [INFO] pika.adapters.blocking_connection: Created new queue consumer generator <_QueueConsumerGeneratorInfo params=('cognitive_events', False, False) consumer_tag='ctag1.38e4e44ef0f047f5a2f39f829930251e'>
2025-07-14 09:08:37 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-14 09:08:37 [INFO] cognitive_system: üß† Sending stop signal to cognitive background loop...
2025-07-14 09:08:47 [INFO] cognitive_system: üß† Cognitive background loop stopped.
2025-07-14 09:08:47 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-14 09:08:47 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_0] Worker thread exiting.
2025-07-14 09:08:47 [INFO] peoples_coin.systems.endocrine_system: [EndocrineWorker_1] Worker thread exiting.
2025-07-14 09:08:47 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-14 09:08:47 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-14 09:08:47 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-14 09:08:47 [INFO] cognitive_system: üß† Sending stop signal to cognitive background loop...
2025-07-14 09:08:57 [INFO] cognitive_system: üß† Cognitive background loop stopped.
2025-07-14 09:08:57 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] Stopping all worker threads...
2025-07-14 09:08:57 [INFO] peoples_coin.systems.endocrine_system: [Endocrine] All worker threads stopped.
2025-07-14 09:08:57 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-15 17:08:05 [INFO] peoples_coin: Creating Flask application instance.
2025-07-15 17:08:05 [INFO] peoples_coin: Using database URI: sqlite:////Users/donfeeney/the-peoples-coin-project/peoples-coin/instance/peoples_coin.db
2025-07-15 17:08:05 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Connected to Redis.
2025-07-15 17:08:05 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-15 17:08:05 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-15 17:08:06 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-15 17:08:06 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-15 17:08:06 [INFO] peoples_coin.systems.circulatory_system: ü´Ä CirculatorySystem initialized and configured.
2025-07-15 17:08:06 [INFO] peoples_coin.systems.endocrine_system: üß† EndocrineSystem initialized: 2 workers, loop delay 5s.
2025-07-15 17:08:06 [INFO] peoples_coin: All systems initialized.
2025-07-15 17:08:06 [INFO] peoples_coin: All blueprints registered.
2025-07-15 17:08:06 [INFO] peoples_coin.consensus: Consensus system instance created.
2025-07-15 17:08:06 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-15 17:08:06 [INFO] peoples_coin: Consensus system initialized.
2025-07-15 17:08:06 [INFO] peoples_coin: Celery initialized and attached to app.extensions.
2025-07-15 17:08:06 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-15 17:08:06 [INFO] peoples_coin.wsgi: Peoples Coin WSGI application starting up.
2025-07-15 17:10:11 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-15 17:10:11 [INFO] peoples_coin.systems.endocrine_system: ‚èπÔ∏è Stopping all worker threads...
2025-07-15 17:10:11 [INFO] peoples_coin.systems.endocrine_system: üßµ All worker threads stopped gracefully.
2025-07-15 17:10:11 [ERROR] peoples_coin: Error stopping immune_system cleaner: 'ImmuneSystem' object has no attribute 'stop_cleaner'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/__init__.py", line 148, in shutdown_systems
    immune_system.stop_cleaner()  # Assuming this is the correct stop method
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImmuneSystem' object has no attribute 'stop_cleaner'. Did you mean: '_start_cleaner'?
2025-07-15 17:10:11 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-15 17:10:22 [INFO] peoples_coin: Creating Flask application instance.
2025-07-15 17:10:22 [INFO] peoples_coin: Using database URI: sqlite:////Users/donfeeney/the-peoples-coin-project/peoples-coin/instance/peoples_coin.db
2025-07-15 17:10:22 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Connected to Redis.
2025-07-15 17:10:22 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-15 17:10:22 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-15 17:10:22 [INFO] peoples_coin: Creating Flask application instance.
2025-07-15 17:10:22 [INFO] peoples_coin: Using database URI: sqlite:////Users/donfeeney/the-peoples-coin-project/peoples-coin/instance/peoples_coin.db
2025-07-15 17:10:22 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Connected to Redis.
2025-07-15 17:10:22 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-15 17:10:22 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-15 17:10:22 [INFO] peoples_coin: Creating Flask application instance.
2025-07-15 17:10:22 [INFO] peoples_coin: Using database URI: sqlite:////Users/donfeeney/the-peoples-coin-project/peoples-coin/instance/peoples_coin.db
2025-07-15 17:10:22 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Connected to Redis.
2025-07-15 17:10:22 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-15 17:10:22 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-15 17:10:22 [INFO] peoples_coin: Creating Flask application instance.
2025-07-15 17:10:22 [INFO] peoples_coin: Using database URI: sqlite:////Users/donfeeney/the-peoples-coin-project/peoples-coin/instance/peoples_coin.db
2025-07-15 17:10:22 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem: Connected to Redis.
2025-07-15 17:10:22 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem in-memory cleaner thread started.
2025-07-15 17:10:22 [INFO] peoples_coin.systems.immune_system: üõ°Ô∏è ImmuneSystem initialized.
2025-07-15 17:10:23 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-15 17:10:23 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-15 17:10:23 [INFO] peoples_coin.systems.circulatory_system: ü´Ä CirculatorySystem initialized and configured.
2025-07-15 17:10:23 [INFO] peoples_coin.systems.endocrine_system: üß† EndocrineSystem initialized: 2 workers, loop delay 5s.
2025-07-15 17:10:23 [INFO] peoples_coin: All systems initialized.
2025-07-15 17:10:23 [INFO] peoples_coin: All blueprints registered.
2025-07-15 17:10:23 [INFO] peoples_coin.consensus: Consensus system instance created.
2025-07-15 17:10:23 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-15 17:10:23 [INFO] peoples_coin: Consensus system initialized.
2025-07-15 17:10:23 [INFO] peoples_coin: Celery initialized and attached to app.extensions.
2025-07-15 17:10:23 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-15 17:10:23 [INFO] peoples_coin.wsgi: Peoples Coin WSGI application starting up.
2025-07-15 17:10:23 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-15 17:10:23 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-15 17:10:23 [INFO] peoples_coin.systems.circulatory_system: ü´Ä CirculatorySystem initialized and configured.
2025-07-15 17:10:23 [INFO] peoples_coin.systems.endocrine_system: üß† EndocrineSystem initialized: 2 workers, loop delay 5s.
2025-07-15 17:10:23 [INFO] peoples_coin: All systems initialized.
2025-07-15 17:10:23 [INFO] peoples_coin: All blueprints registered.
2025-07-15 17:10:23 [INFO] peoples_coin.consensus: Consensus system instance created.
2025-07-15 17:10:23 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-15 17:10:23 [INFO] peoples_coin: Consensus system initialized.
2025-07-15 17:10:23 [INFO] peoples_coin: Celery initialized and attached to app.extensions.
2025-07-15 17:10:23 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-15 17:10:23 [INFO] peoples_coin.wsgi: Peoples Coin WSGI application starting up.
2025-07-15 17:10:23 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-15 17:10:23 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-15 17:10:23 [INFO] peoples_coin.systems.circulatory_system: ü´Ä CirculatorySystem initialized and configured.
2025-07-15 17:10:23 [INFO] peoples_coin.systems.endocrine_system: üß† EndocrineSystem initialized: 2 workers, loop delay 5s.
2025-07-15 17:10:23 [INFO] peoples_coin: All systems initialized.
2025-07-15 17:10:23 [INFO] cognitive_system: ‚òÅÔ∏è Google Cloud Firestore client initialized.
2025-07-15 17:10:23 [INFO] cognitive_system: üß† Cognitive System initialized and ready to start.
2025-07-15 17:10:23 [INFO] peoples_coin.systems.circulatory_system: ü´Ä CirculatorySystem initialized and configured.
2025-07-15 17:10:23 [INFO] peoples_coin.systems.endocrine_system: üß† EndocrineSystem initialized: 2 workers, loop delay 5s.
2025-07-15 17:10:23 [INFO] peoples_coin: All systems initialized.
2025-07-15 17:10:23 [INFO] peoples_coin: All blueprints registered.
2025-07-15 17:10:23 [INFO] peoples_coin.consensus: Consensus system instance created.
2025-07-15 17:10:23 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-15 17:10:23 [INFO] peoples_coin: Consensus system initialized.
2025-07-15 17:10:23 [INFO] peoples_coin: Celery initialized and attached to app.extensions.
2025-07-15 17:10:23 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-15 17:10:23 [INFO] peoples_coin.wsgi: Peoples Coin WSGI application starting up.
2025-07-15 17:10:23 [INFO] peoples_coin: All blueprints registered.
2025-07-15 17:10:23 [INFO] peoples_coin.consensus: Consensus system instance created.
2025-07-15 17:10:23 [INFO] peoples_coin.consensus: Consensus system configured with difficulty: 0000.
2025-07-15 17:10:23 [INFO] peoples_coin: Consensus system initialized.
2025-07-15 17:10:23 [INFO] peoples_coin: Celery initialized and attached to app.extensions.
2025-07-15 17:10:23 [INFO] peoples_coin: üöÄ Application factory setup complete.
2025-07-15 17:10:23 [INFO] peoples_coin.wsgi: Peoples Coin WSGI application starting up.
2025-07-15 17:16:56 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-15 17:16:56 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-15 17:16:56 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-15 17:16:56 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-15 17:16:56 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-15 17:16:56 [INFO] peoples_coin: Initiating graceful shutdown of background systems...
2025-07-15 17:16:56 [INFO] peoples_coin.systems.endocrine_system: ‚èπÔ∏è Stopping all worker threads...
2025-07-15 17:16:56 [INFO] peoples_coin.systems.endocrine_system: ‚èπÔ∏è Stopping all worker threads...
2025-07-15 17:16:56 [INFO] peoples_coin.systems.endocrine_system: ‚èπÔ∏è Stopping all worker threads...
2025-07-15 17:16:56 [INFO] peoples_coin.systems.endocrine_system: ‚èπÔ∏è Stopping all worker threads...
2025-07-15 17:16:56 [INFO] peoples_coin.systems.endocrine_system: üßµ All worker threads stopped gracefully.
2025-07-15 17:16:56 [INFO] peoples_coin.systems.endocrine_system: üßµ All worker threads stopped gracefully.
2025-07-15 17:16:56 [INFO] peoples_coin.systems.endocrine_system: üßµ All worker threads stopped gracefully.
2025-07-15 17:16:56 [INFO] peoples_coin.systems.endocrine_system: üßµ All worker threads stopped gracefully.
2025-07-15 17:16:56 [ERROR] peoples_coin: Error stopping immune_system cleaner: 'ImmuneSystem' object has no attribute 'stop_cleaner'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/__init__.py", line 148, in shutdown_systems
    immune_system.stop_cleaner()  # Assuming this is the correct stop method
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImmuneSystem' object has no attribute 'stop_cleaner'. Did you mean: '_start_cleaner'?
2025-07-15 17:16:56 [ERROR] peoples_coin: Error stopping immune_system cleaner: 'ImmuneSystem' object has no attribute 'stop_cleaner'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/__init__.py", line 148, in shutdown_systems
    immune_system.stop_cleaner()  # Assuming this is the correct stop method
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImmuneSystem' object has no attribute 'stop_cleaner'. Did you mean: '_start_cleaner'?
2025-07-15 17:16:56 [ERROR] peoples_coin: Error stopping immune_system cleaner: 'ImmuneSystem' object has no attribute 'stop_cleaner'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/__init__.py", line 148, in shutdown_systems
    immune_system.stop_cleaner()  # Assuming this is the correct stop method
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImmuneSystem' object has no attribute 'stop_cleaner'. Did you mean: '_start_cleaner'?
2025-07-15 17:16:56 [ERROR] peoples_coin: Error stopping immune_system cleaner: 'ImmuneSystem' object has no attribute 'stop_cleaner'
Traceback (most recent call last):
  File "/Users/donfeeney/the-peoples-coin-project/peoples-coin/src/peoples_coin/__init__.py", line 148, in shutdown_systems
    immune_system.stop_cleaner()  # Assuming this is the correct stop method
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImmuneSystem' object has no attribute 'stop_cleaner'. Did you mean: '_start_cleaner'?
2025-07-15 17:16:56 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-15 17:16:56 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-15 17:16:56 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-15 17:16:56 [INFO] peoples_coin: ‚úÖ All background systems shut down successfully.
2025-07-16 12:53:04 [INFO] alembic.runtime.migration: Context impl SQLiteImpl.
2025-07-16 12:53:04 [INFO] alembic.runtime.migration: Will assume non-transactional DDL.
2025-07-16 12:53:04 [ERROR] alembic.util.messaging: Target database is not up to date.
2025-07-16 12:53:41 [INFO] alembic.runtime.migration: Context impl SQLiteImpl.
2025-07-16 12:53:41 [INFO] alembic.runtime.migration: Will assume non-transactional DDL.
2025-07-16 12:53:41 [INFO] alembic.runtime.migration: Running upgrade  -> 90e53ab6e209, Create initial tables and update GoodwillAction for AILEE
2025-07-16 12:59:04 [INFO] alembic.runtime.migration: Context impl SQLiteImpl.
2025-07-16 12:59:04 [INFO] alembic.runtime.migration: Will assume non-transactional DDL.
2025-07-16 12:59:04 [INFO] alembic.autogenerate.compare: Detected removed index 'idx_event_type_timestamp' on 'event_logs'
2025-07-16 12:59:04 [INFO] alembic.autogenerate.compare: Detected removed index 'ix_event_logs_event_type' on 'event_logs'
2025-07-16 12:59:04 [INFO] alembic.autogenerate.compare: Detected removed table 'event_logs'
2025-07-16 12:59:04 [INFO] alembic.autogenerate.compare: Detected removed table 'user_accounts'
2025-07-16 12:59:04 [INFO] alembic.autogenerate.compare: Detected removed index 'idx_processed_created_at' on 'data_entries'
2025-07-16 12:59:04 [INFO] alembic.autogenerate.compare: Detected removed table 'data_entries'
2025-07-16 12:59:04 [INFO] alembic.autogenerate.compare: Detected removed table 'consensus_nodes'
2025-07-16 12:59:04 [INFO] alembic.autogenerate.compare: Detected removed index 'idx_goodwill_status' on 'goodwill_actions'
2025-07-16 12:59:04 [INFO] alembic.autogenerate.compare: Detected removed index 'ix_goodwill_actions_user_id' on 'goodwill_actions'
2025-07-16 12:59:04 [INFO] alembic.autogenerate.compare: Detected removed table 'goodwill_actions'
2025-07-16 12:59:04 [INFO] alembic.autogenerate.compare: Detected removed index 'ix_chain_blocks_hash' on 'chain_blocks'
2025-07-16 12:59:04 [INFO] alembic.autogenerate.compare: Detected removed table 'chain_blocks'
2025-07-16 13:15:39 [INFO] alembic.runtime.migration: Context impl SQLiteImpl.
2025-07-16 13:15:39 [INFO] alembic.runtime.migration: Will assume non-transactional DDL.
2025-07-16 13:15:39 [ERROR] alembic.util.messaging: Can't locate revision identified by '90e53ab6e209'
2025-07-16 13:16:47 [INFO] alembic.runtime.migration: Context impl SQLiteImpl.
2025-07-16 13:16:47 [INFO] alembic.runtime.migration: Will assume non-transactional DDL.
2025-07-16 13:16:47 [ERROR] alembic.util.messaging: Can't locate revision identified by '90e53ab6e209'
2025-07-16 13:17:57 [INFO] alembic.runtime.migration: Context impl SQLiteImpl.
2025-07-16 13:17:57 [INFO] alembic.runtime.migration: Will assume non-transactional DDL.
2025-07-16 13:17:57 [ERROR] alembic.util.messaging: Can't locate revision identified by '90e53ab6e209'
2025-07-16 13:19:31 [INFO] alembic.runtime.migration: Context impl SQLiteImpl.
2025-07-16 13:19:31 [INFO] alembic.runtime.migration: Will assume non-transactional DDL.
2025-07-16 13:19:31 [ERROR] alembic.util.messaging: Can't locate revision identified by '90e53ab6e209'
